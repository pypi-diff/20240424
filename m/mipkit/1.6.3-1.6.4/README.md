# Comparing `tmp/mipkit-1.6.3-py3-none-any.whl.zip` & `tmp/mipkit-1.6.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,51 +1,52 @@
-Zip file size: 68568 bytes, number of entries: 49
--rw-r--r--  2.0 unx     1531 b- defN 22-Dec-07 07:00 mipkit/__init__.py
--rw-r--r--  2.0 unx     4301 b- defN 22-Dec-07 06:51 mipkit/audio.py
--rw-r--r--  2.0 unx     2370 b- defN 22-Dec-07 06:52 mipkit/debug.py
--rw-r--r--  2.0 unx     2292 b- defN 22-Dec-07 06:50 mipkit/downloaders.py
--rw-r--r--  2.0 unx      518 b- defN 22-May-25 21:18 mipkit/helpers.py
--rw-r--r--  2.0 unx     9092 b- defN 22-Dec-07 06:50 mipkit/images.py
--rw-r--r--  2.0 unx     2265 b- defN 22-Dec-07 06:50 mipkit/logger.py
--rw-r--r--  2.0 unx     2691 b- defN 22-Dec-07 06:50 mipkit/multiprocessing.py
--rw-r--r--  2.0 unx     3201 b- defN 22-May-25 21:20 mipkit/pdf.py
--rw-r--r--  2.0 unx     4058 b- defN 22-May-25 21:19 mipkit/pl_utils.py
--rw-r--r--  2.0 unx     1981 b- defN 22-Dec-07 06:50 mipkit/stats.py
--rw-r--r--  2.0 unx     9758 b- defN 22-Dec-07 06:50 mipkit/utils.py
--rw-r--r--  2.0 unx     2225 b- defN 22-Dec-07 06:53 mipkit/video.py
--rw-r--r--  2.0 unx    13205 b- defN 22-Dec-07 06:49 mipkit/vis.py
--rw-r--r--  2.0 unx     1264 b- defN 22-Jul-30 23:13 mipkit/dl/__init__.py
--rw-r--r--  2.0 unx     3530 b- defN 22-May-25 19:33 mipkit/dl/losses.py
--rw-r--r--  2.0 unx     4002 b- defN 22-May-25 19:33 mipkit/dl/metrics.py
--rw-r--r--  2.0 unx     5174 b- defN 22-May-25 19:33 mipkit/dl/summary.py
--rw-r--r--  2.0 unx     4567 b- defN 22-May-25 19:33 mipkit/dl/tune.py
--rw-r--r--  2.0 unx     2650 b- defN 22-May-25 19:33 mipkit/dl/utils.py
--rw-r--r--  2.0 unx     1226 b- defN 22-May-25 19:33 mipkit/faces/__init__.py
--rw-r--r--  2.0 unx     3584 b- defN 22-May-25 19:33 mipkit/faces/faces_utils.py
--rw-r--r--  2.0 unx     1645 b- defN 22-May-25 19:33 mipkit/faces/helpers.py
--rw-r--r--  2.0 unx     1255 b- defN 22-May-25 19:33 mipkit/ip/__init__.py
--rw-r--r--  2.0 unx     3593 b- defN 22-May-25 19:33 mipkit/ip/fft.py
--rw-r--r--  2.0 unx     8485 b- defN 22-May-25 19:33 mipkit/ip/freq_filters.py
--rw-r--r--  2.0 unx     1369 b- defN 22-May-25 19:33 mipkit/medical/__init__.py
--rw-r--r--  2.0 unx     1763 b- defN 22-May-25 19:33 mipkit/medical/itk_snap.py
--rw-r--r--  2.0 unx     4527 b- defN 22-May-25 19:33 mipkit/medical/utils.py
--rw-r--r--  2.0 unx      465 b- defN 22-May-25 19:33 mipkit/medical/vis.py
--rw-r--r--  2.0 unx     1231 b- defN 22-May-25 19:33 mipkit/nlp/__init__.py
--rw-r--r--  2.0 unx     1233 b- defN 22-May-25 19:33 mipkit/nlp/text_cleaner/__init__.py
--rw-r--r--  2.0 unx     3718 b- defN 22-May-25 19:33 mipkit/nlp/text_cleaner/cleaner.py
--rw-r--r--  2.0 unx    13483 b- defN 22-May-25 19:33 mipkit/nlp/text_cleaner/constants.py
--rw-r--r--  2.0 unx    13466 b- defN 22-May-25 19:33 mipkit/nlp/text_cleaner/core.py
--rw-r--r--  2.0 unx     2293 b- defN 22-May-25 19:33 mipkit/nlp/text_cleaner/specials.py
--rw-r--r--  2.0 unx     2741 b- defN 22-May-25 19:33 mipkit/nlp/text_cleaner/utils.py
--rw-r--r--  2.0 unx     1317 b- defN 22-Dec-07 06:59 mipkit/pytorch/__init__.py
--rw-r--r--  2.0 unx     2715 b- defN 22-May-25 19:33 mipkit/pytorch/base.py
--rw-r--r--  2.0 unx     2415 b- defN 22-Dec-07 06:59 mipkit/pytorch/hook.py
--rw-r--r--  2.0 unx     1859 b- defN 22-May-25 19:33 mipkit/pytorch/losses.py
--rw-r--r--  2.0 unx     2145 b- defN 22-Dec-07 06:59 mipkit/pytorch/utils.py
--rw-r--r--  2.0 unx     1097 b- defN 22-Dec-07 07:02 mipkit-1.6.3.dist-info/LICENSE
--rw-r--r--  2.0 unx     1180 b- defN 22-Dec-07 07:02 mipkit-1.6.3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Dec-07 07:02 mipkit-1.6.3.dist-info/WHEEL
--rw-r--r--  2.0 unx       46 b- defN 22-Dec-07 07:02 mipkit-1.6.3.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        7 b- defN 22-Dec-07 07:02 mipkit-1.6.3.dist-info/top_level.txt
--rw-r--r--  2.0 unx        1 b- defN 22-Dec-07 06:48 mipkit-1.6.3.dist-info/zip-safe
-?rw-rw-r--  2.0 unx     3875 b- defN 22-Dec-07 07:02 mipkit-1.6.3.dist-info/RECORD
-49 files, 163501 bytes uncompressed, 62532 bytes compressed:  61.8%
+Zip file size: 70722 bytes, number of entries: 50
+-rw-r--r--  2.0 unx     1425 b- defN 24-Mar-05 02:55 mipkit/__init__.py
+-rw-r--r--  2.0 unx     4268 b- defN 23-Dec-16 10:31 mipkit/audio.py
+-rw-r--r--  2.0 unx     2469 b- defN 24-Mar-04 03:51 mipkit/debug.py
+-rw-r--r--  2.0 unx     2317 b- defN 23-Dec-16 10:31 mipkit/downloaders.py
+-rw-r--r--  2.0 unx      517 b- defN 23-Dec-16 10:31 mipkit/helpers.py
+-rw-r--r--  2.0 unx     9084 b- defN 23-Dec-16 10:31 mipkit/images.py
+-rw-r--r--  2.0 unx     2245 b- defN 23-Dec-16 10:31 mipkit/logger.py
+-rw-r--r--  2.0 unx     2670 b- defN 23-Dec-16 10:31 mipkit/mprocess.py
+-rw-r--r--  2.0 unx     8062 b- defN 23-Dec-16 10:33 mipkit/nest_asyncio.py
+-rw-r--r--  2.0 unx     3203 b- defN 23-Dec-16 10:31 mipkit/pdf.py
+-rw-r--r--  2.0 unx     3751 b- defN 23-Dec-16 10:31 mipkit/pl_utils.py
+-rw-r--r--  2.0 unx     1956 b- defN 23-Dec-16 10:31 mipkit/stats.py
+-rw-r--r--  2.0 unx     9810 b- defN 23-Dec-16 10:31 mipkit/utils.py
+-rw-r--r--  2.0 unx     2229 b- defN 23-Dec-16 10:31 mipkit/video.py
+-rw-r--r--  2.0 unx    13188 b- defN 23-Dec-16 10:31 mipkit/vis.py
+-rw-r--r--  2.0 unx     1243 b- defN 23-Dec-16 10:31 mipkit/dl/__init__.py
+-rw-r--r--  2.0 unx     3391 b- defN 23-Dec-16 10:31 mipkit/dl/losses.py
+-rw-r--r--  2.0 unx     3980 b- defN 23-Dec-16 10:31 mipkit/dl/metrics.py
+-rw-r--r--  2.0 unx     5045 b- defN 23-Dec-16 10:31 mipkit/dl/summary.py
+-rw-r--r--  2.0 unx     4234 b- defN 23-Dec-16 10:31 mipkit/dl/tune.py
+-rw-r--r--  2.0 unx     2650 b- defN 23-Jun-23 06:09 mipkit/dl/utils.py
+-rw-r--r--  2.0 unx     1205 b- defN 23-Dec-16 10:31 mipkit/faces/__init__.py
+-rw-r--r--  2.0 unx     3487 b- defN 23-Dec-16 10:31 mipkit/faces/faces_utils.py
+-rw-r--r--  2.0 unx     1616 b- defN 23-Dec-16 10:31 mipkit/faces/helpers.py
+-rw-r--r--  2.0 unx     1234 b- defN 23-Dec-16 10:31 mipkit/ip/__init__.py
+-rw-r--r--  2.0 unx     3538 b- defN 23-Dec-16 10:31 mipkit/ip/fft.py
+-rw-r--r--  2.0 unx     8421 b- defN 23-Dec-16 10:31 mipkit/ip/freq_filters.py
+-rw-r--r--  2.0 unx     1352 b- defN 23-Dec-16 10:31 mipkit/medical/__init__.py
+-rw-r--r--  2.0 unx     1757 b- defN 23-Dec-16 10:31 mipkit/medical/itk_snap.py
+-rw-r--r--  2.0 unx     4489 b- defN 23-Dec-16 10:31 mipkit/medical/utils.py
+-rw-r--r--  2.0 unx      444 b- defN 23-Dec-16 10:31 mipkit/medical/vis.py
+-rw-r--r--  2.0 unx     1210 b- defN 23-Dec-16 10:31 mipkit/nlp/__init__.py
+-rw-r--r--  2.0 unx     1212 b- defN 23-Dec-16 10:31 mipkit/nlp/text_cleaner/__init__.py
+-rw-r--r--  2.0 unx     3684 b- defN 23-Dec-16 10:31 mipkit/nlp/text_cleaner/cleaner.py
+-rw-r--r--  2.0 unx    13462 b- defN 23-Dec-16 10:31 mipkit/nlp/text_cleaner/constants.py
+-rw-r--r--  2.0 unx    13445 b- defN 23-Dec-16 10:31 mipkit/nlp/text_cleaner/core.py
+-rw-r--r--  2.0 unx     2185 b- defN 23-Dec-16 10:31 mipkit/nlp/text_cleaner/specials.py
+-rw-r--r--  2.0 unx     2721 b- defN 23-Dec-16 10:31 mipkit/nlp/text_cleaner/utils.py
+-rw-r--r--  2.0 unx     1274 b- defN 23-Dec-16 10:31 mipkit/pytorch/__init__.py
+-rw-r--r--  2.0 unx     2531 b- defN 23-Dec-16 10:31 mipkit/pytorch/base.py
+-rw-r--r--  2.0 unx     2405 b- defN 23-Dec-16 10:31 mipkit/pytorch/hook.py
+-rw-r--r--  2.0 unx     1850 b- defN 23-Dec-16 10:31 mipkit/pytorch/losses.py
+-rw-r--r--  2.0 unx     2149 b- defN 23-Dec-16 10:31 mipkit/pytorch/utils.py
+-rw-r--r--  2.0 unx     1097 b- defN 24-Apr-24 09:30 mipkit-1.6.4.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1180 b- defN 24-Apr-24 09:30 mipkit-1.6.4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-24 09:30 mipkit-1.6.4.dist-info/WHEEL
+-rw-r--r--  2.0 unx       46 b- defN 24-Apr-24 09:30 mipkit-1.6.4.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        7 b- defN 24-Apr-24 09:30 mipkit-1.6.4.dist-info/top_level.txt
+-rw-r--r--  2.0 unx        1 b- defN 23-Dec-16 10:59 mipkit-1.6.4.dist-info/zip-safe
+-rw-rw-r--  2.0 unx     3947 b- defN 24-Apr-24 09:30 mipkit-1.6.4.dist-info/RECORD
+50 files, 169778 bytes uncompressed, 64580 bytes compressed:  62.0%
```

## zipnote {}

```diff
@@ -15,15 +15,18 @@
 
 Filename: mipkit/images.py
 Comment: 
 
 Filename: mipkit/logger.py
 Comment: 
 
-Filename: mipkit/multiprocessing.py
+Filename: mipkit/mprocess.py
+Comment: 
+
+Filename: mipkit/nest_asyncio.py
 Comment: 
 
 Filename: mipkit/pdf.py
 Comment: 
 
 Filename: mipkit/pl_utils.py
 Comment: 
@@ -120,29 +123,29 @@
 
 Filename: mipkit/pytorch/losses.py
 Comment: 
 
 Filename: mipkit/pytorch/utils.py
 Comment: 
 
-Filename: mipkit-1.6.3.dist-info/LICENSE
+Filename: mipkit-1.6.4.dist-info/LICENSE
 Comment: 
 
-Filename: mipkit-1.6.3.dist-info/METADATA
+Filename: mipkit-1.6.4.dist-info/METADATA
 Comment: 
 
-Filename: mipkit-1.6.3.dist-info/WHEEL
+Filename: mipkit-1.6.4.dist-info/WHEEL
 Comment: 
 
-Filename: mipkit-1.6.3.dist-info/entry_points.txt
+Filename: mipkit-1.6.4.dist-info/entry_points.txt
 Comment: 
 
-Filename: mipkit-1.6.3.dist-info/top_level.txt
+Filename: mipkit-1.6.4.dist-info/top_level.txt
 Comment: 
 
-Filename: mipkit-1.6.3.dist-info/zip-safe
+Filename: mipkit-1.6.4.dist-info/zip-safe
 Comment: 
 
-Filename: mipkit-1.6.3.dist-info/RECORD
+Filename: mipkit-1.6.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mipkit/__init__.py

```diff
@@ -1,42 +1,43 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
-from . import vis
-from . import multiprocessing
-from . import utils
-from . import stats
-from . import downloaders
-from . import images
-from . import logger
-from . import audio
+from . import (
+    audio,
+    downloaders,
+    images,
+    logger,
+    mprocess,
+    pytorch,
+    stats,
+    utils,
+    video,
+    vis,
+)
 from .debug import *
-from . import video
-from . import pytorch 
+
 # from . import faces
 # from . import medical
 # from . import nlp
 # from . import dl
 # from .helpers import *
-
-
```

## mipkit/audio.py

```diff
@@ -1,40 +1,42 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 import warnings
+
 try:
     import librosa
     import numpy as np
-    from matplotlib import cm
     import pylab
+    from matplotlib import cm
 except ImportError as e:
     warnings.warn(e.msg)
-    
+
+
 def load_file(fp, sr=None):
     X, sr = librosa.load(fp, sr=sr)
     return X, sr
 
 
 def scale_minmax(X, min=0.0, max=1.0):
     esp = 10e-9
@@ -57,16 +59,15 @@
 N_FFT = 1024  # 2048
 HOP_LENGTH = 512
 N_MELS = 96
 N_MFCC = 40
 
 
 def wav2mfcc(wav_arr, sr, n_mfcc=N_FFT, **args):
-    mfcc = librosa.feature.mfcc(
-        y=wav_arr, sr=sr, S=None, n_mfcc=n_mfcc, **args)
+    mfcc = librosa.feature.mfcc(y=wav_arr, sr=sr, S=None, n_mfcc=n_mfcc, **args)
     return mfcc
 
 
 def save_mfcc(mel, path_to_save):
     # Plotting the spectrogram and save as JPG without axes (just the image)
     # pylab.figure(figsize=(3, 3))
     pylab.axis("off")
```

## mipkit/debug.py

```diff
@@ -1,63 +1,75 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 # ===============================================================================
 # DEBUGGER
 #
 # References
 # [1] https://stackoverflow.com/questions/16867347/step-by-step-debugging-with-ipython
 # ===============================================================================
+import asyncio
+
 
 class Debugger:
+
     def __init__(self, method="ipython"):
         """Debugger with available methods: ipdb, pdb or ipython
 
         Args:
             method (str, optional): debugger method. Defaults to 'ipdb'.
         """
         self.tracer = self.init_tracer(method)
 
     def init_tracer(self, method):
         assert method in ["ipdb", "pdb", "ipython", "bpython"]
         if method == "ipdb":
             import ipdb
+
             return ipdb.set_trace
         elif method == "pdb":
             import pdb
+
             return pdb.set_trace
         elif method == "ipython":
             import IPython
+
             return IPython.embed
         elif method == "bpython":
             import bpython
+
             return bpython.embed
 
     def set_trace(self, method=None):
         if method is not None:
             self.tracer = self.init_tracer(method)
         return self.tracer
 
 
+if asyncio.get_event_loop().is_running():
+    from . import nest_asyncio
+
+    nest_asyncio.apply()
+
 set_trace = Debugger().set_trace()
```

## mipkit/downloaders.py

```diff
@@ -1,58 +1,65 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
-import urllib.request as urllib_request
-from io import BytesIO
 import time
+import urllib.request as urllib_request
 import warnings
+from io import BytesIO
+
 try:
     from PIL import Image
 except ImportError as e:
-    warnings.warn(e.msg)    
+    warnings.warn(e.msg)
+
 
 def download_img_with_url(url, retry=0, retry_gap=0.1, proxy=None):
     if proxy == None:
         proxies = {}
     else:
-        proxies = {'http': proxy, 'https': proxy}
+        proxies = {"http": proxy, "https": proxy}
     try:
         proxy_handler = urllib_request.ProxyHandler(proxies)
         opener = urllib_request.build_opener(proxy_handler)
-        img = Image.open(BytesIO(opener.open(url).read())).convert('RGB')
+        img = Image.open(BytesIO(opener.open(url).read())).convert("RGB")
         return img
     except Exception as e:
         if retry > 0:
             time.sleep(retry_gap)
-            return download_img_with_url(url, retry=retry-1, proxy=proxy)
+            return download_img_with_url(url, retry=retry - 1, proxy=proxy)
         else:
             return None
 
 
 def download_from_youtube(output_path, video_id):
     try:
         from pytube import YouTube
     except ImportError as e:
-        raise ImportError('No package `pytube`, cannot execute `download_from_youtube`.')
-    yt = YouTube(f'https://youtu.be/watch?v={video_id}').streams.first().download(
-        output_path=output_path, filename=video_id)
+        raise ImportError(
+            "No package `pytube`, cannot execute `download_from_youtube`."
+        )
+    yt = (
+        YouTube(f"https://youtu.be/watch?v={video_id}")
+        .streams.first()
+        .download(output_path=output_path, filename=video_id)
+    )
```

## mipkit/helpers.py

```diff
@@ -1,16 +1,18 @@
+import importlib
 import pkgutil
+
 import pip
-import importlib
+
 
 def install_and_import(package_name, install_if_not_found=True, required_version=None):
     if pkgutil.find_loader(package_name) is None:
         if install_if_not_found:
             install_package_name = (
                 f"{package_name}=={required_version}"
                 if required_version
                 else f"{package_name}"
             )
             pip.main(["install", install_package_name])
-    
+
     else:
-        return importlib.import_module(package_name)
+        return importlib.import_module(package_name)
```

## mipkit/images.py

```diff
@@ -1,42 +1,43 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 import warnings
+
 from .utils import deprecated
+
 try:
     import cv2
-    from PIL import Image, ImageDraw
     import numpy as np
     import PIL
     import torchvision.transforms.functional as F
+    from PIL import Image, ImageDraw
 except ImportError as e:
     warnings.warn(e.msg)
-    
 
 
 def combine_images(images: list, axis=1):
     """Combine images
 
     Args:
         images (list): image list (must have the same dimension)
@@ -44,65 +45,73 @@
             When axis = 0, the images are merged vertically;
             When axis = 1, the images are merged horizontally.
     Returns:
         merge image
     """
     ndim = images[0].ndim
     shapes = np.array([mat.shape for mat in images])
-    assert np.all(map(lambda e: len(e) == ndim, shapes)
-                  ), 'all images should be same ndim.'
+    assert np.all(
+        map(lambda e: len(e) == ndim, shapes)
+    ), "all images should be same ndim."
     if axis == 0:  # merge images vertically
-
         # Merge image cols
         cols = np.max(shapes[:, 1])
 
         # Expand the cols size of each image to make the cols consistent
-        copy_imgs = [cv2.copyMakeBorder(img, 0, 0, 0, cols - img.shape[1],
-                                        cv2.BORDER_CONSTANT, (0, 0, 0)) for img in images]
+        copy_imgs = [
+            cv2.copyMakeBorder(
+                img, 0, 0, 0, cols - img.shape[1], cv2.BORDER_CONSTANT, (0, 0, 0)
+            )
+            for img in images
+        ]
         # Merge vertically
         return np.vstack(copy_imgs)
 
     else:  # merge images horizontally
         # Combine the rows of the image
         rows = np.max(shapes[:, 0])
 
         # Expand the row size of each image to make rows consistent
-        copy_imgs = [cv2.copyMakeBorder(img, 0, rows - img.shape[0], 0, 0,
-                                        cv2.BORDER_CONSTANT, (0, 0, 0)) for img in images]
+        copy_imgs = [
+            cv2.copyMakeBorder(
+                img, 0, rows - img.shape[0], 0, 0, cv2.BORDER_CONSTANT, (0, 0, 0)
+            )
+            for img in images
+        ]
 
         # Merge horizontally
         return np.hstack(copy_imgs)
 
 
 def convert_to_torch_image(img):
-    """ Convert the image to a torch image.
-        Code:
-            img = torch.tensor(img)
-            img = img.permute((2, 0, 1)).contiguous()
-            if isinstance(img, torch.ByteTensor):
-                return img.float().div(255)
-            else:
-                return img
+    """Convert the image to a torch image.
+    Code:
+        img = torch.tensor(img)
+        img = img.permute((2, 0, 1)).contiguous()
+        if isinstance(img, torch.ByteTensor):
+            return img.float().div(255)
+        else:
             return img
+        return img
     """
     return F.to_tensor(img)
 
 
 def read_image(file_path, to_rgb=True, use_cv2=False):
     if use_cv2:
         img = cv2.imread(file_path)
         if to_rgb:
             img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)
     else:
         img = Image.open(file_path)
-        img = img.convert('RGB')
+        img = img.convert("RGB")
     return img
 
 
-@deprecated('Only for specific experiments')
+@deprecated("Only for specific experiments")
 def read_image_experiments(file_path: str, to_rgb=True, vis=False, to_tensor=False):
     """Load and convert a ``PIL Image`` or ``numpy.ndarray`` to tensor. This transform does not support torchscript.
 
     Converts a PIL Image or numpy.ndarray (H x W x C) in the range
     [0, 255] to a torch.FloatTensor of shape (C x H x W) in the range [0.0, 1.0]
     if the PIL Image belongs to one of the modes (L, LA, P, I, F, RGB, YCbCr, RGBA, CMYK, 1)
     or if the numpy.ndarray has dtype = np.uint8
@@ -115,39 +124,39 @@
 
     .. _references: https://github.com/pytorch/vision/tree/master/references/segmentation
     """
     img = read_image(file_path, to_rgb=to_rgb, vis=vis)
 
     if to_tensor:
         img_tensor = convert_to_torch_image(img)
-    return {'img_raw': img,
-            'img_tensor': img_tensor
-            }
+    return {"img_raw": img, "img_tensor": img_tensor}
 
 
 def padding_image(img_arr):
     w, h, c = img_arr.shape
     if w > h:
-        padd = (w - h)//2
+        padd = (w - h) // 2
         img_arr = cv2.copyMakeBorder(
-            img_arr.copy(), 10, 10, padd, padd, cv2.BORDER_CONSTANT, value=0)
+            img_arr.copy(), 10, 10, padd, padd, cv2.BORDER_CONSTANT, value=0
+        )
     elif w < h:
-        padd = (h - w)//2
+        padd = (h - w) // 2
         img_arr = cv2.copyMakeBorder(
-            img_arr.copy(), padd, padd, 10, 10, cv2.BORDER_CONSTANT, value=0)
+            img_arr.copy(), padd, padd, 10, 10, cv2.BORDER_CONSTANT, value=0
+        )
     return img_arr
 
 
 def _get_type(img):
     if isinstance(img, Image.Image):
-        return 'pil'
+        return "pil"
     elif isinstance(img, np.ndarray):
-        return 'np'
+        return "np"
     else:
-        raise ValueError('Unknown type!')
+        raise ValueError("Unknown type!")
 
 
 def _is_ndarray(inp):
     assert isinstance(inp, np.ndarray)
 
 
 def _is_list(inp):
@@ -160,55 +169,55 @@
 def square_box(img, box):
     _is_list(box)
     if isinstance(img, PIL.Image.Image):
         w, h = img.size
     elif isinstance(img, np.ndarray):
         h, w, c = img.shape
     else:
-        raise TypeError('img is not valid. Expect `ndarray` or `PIL`')
+        raise TypeError("img is not valid. Expect `ndarray` or `PIL`")
     x, y, xx, yy = box
-    _cx = (xx + x)/2
-    _delta_y = (yy - y)/2
+    _cx = (xx + x) / 2
+    _delta_y = (yy - y) / 2
     x = int(np.max([0, _cx - _delta_y]))
     xx = int(np.min([w, _cx + _delta_y]))
 
     x = np.max([0, x])
     y = np.max([0, y])
     return [x, y, xx, yy]
 
 
 def compute_bbox_area(bbox):
     x, y, xx, yy = bbox
     return (yy - y) * (y - x)
 
 
 def get_biggest_bbox_area(bboxes):
-    """Return the biggest bounding box with corresponding index     
+    """Return the biggest bounding box with corresponding index
 
     Args:
-        bboxes (numpy.array, list): list of bboxes 
+        bboxes (numpy.array, list): list of bboxes
 
     Returns:
         tuple: the biggest bbox, index
     """
     if len(bboxes) > 0:
         biggest_idx = np.argmax([compute_bbox_area(bbox) for bbox in bboxes])
         return bboxes[biggest_idx], biggest_idx
     else:
         return bboxes, -1
 
 
 def crop_img(img, box):
     mode = _get_type(img)
-    if mode == 'np':
+    if mode == "np":
         return np_crop_img(img, box)
-    elif mode == 'pil':
+    elif mode == "pil":
         return pil_crop_img(img, box)
     else:
-        raise ValueError('Unknown mode!')
+        raise ValueError("Unknown mode!")
 
 
 def maskout_img(img_arr, box, mask_value=0):
     x, y, xx, yy = box
     img_arr[y:yy, x:xx, ...] = mask_value
     return img_arr
 
@@ -219,17 +228,17 @@
 
 
 def pil_crop_img(img_pil, box):
     img_pil = img_pil.crop(box)
     return img_pil
 
 
-def load_image_from_file(fpath, mode='rgb', to_numpy=False):
+def load_image_from_file(fpath, mode="rgb", to_numpy=False):
     pil_img = Image.open(fpath)
-    pil_img = pil_img.convert('RGB')
+    pil_img = pil_img.convert("RGB")
     if to_numpy:
         return np.array(pil_img)
     return pil_img
 
 
 def binarize_mask(img_arr, threshold=0.5):
     img_arr = img_arr.copy()
@@ -253,62 +262,61 @@
 def rgb_to_gray(img_arr):
     return cv2.cvtColor(img_arr, cv2.COLOR_RGB2GRAY)
 
 
 def expand_box(img, box, ratio=1.0):
     _is_list(box)
     mode = _get_type(img)
-    if mode == 'np':
+    if mode == "np":
         w, h, c = img.shape
-    elif mode == 'pil':
+    elif mode == "pil":
         w, h = img.size
     else:
-        raise ValueError('Unknown mode!')
+        raise ValueError("Unknown mode!")
     x, y, xx, yy = box
     _w = xx - x
-    delta_x = _w*ratio - _w
+    delta_x = _w * ratio - _w
     x -= delta_x
     y -= delta_x
     xx += delta_x
     yy += delta_x
     x = int(np.max([0, x]))
     y = int(np.max([0, y]))
     xx = int(np.max([0, xx]))
     yy = int(np.max([0, yy]))
     return [x, y, xx, yy]
 
 
 # PIL Function
 def center_crop(img_pil, ratio=0.1):
     w, h = img_pil.size
-    h_ = int(ratio*h)
-    w_ = int(ratio*w)
-    return img_pil.crop([w_, h_, h-h_, w-w_])
+    h_ = int(ratio * h)
+    w_ = int(ratio * w)
+    return img_pil.crop([w_, h_, h - h_, w - w_])
 
 
 def random_shift_box(img_pil, bbox, ratio=0.2):
     w = bbox[2] - bbox[0]
-    delta_x = np.random.randint(-int(ratio*w), int(ratio*w))
-    delta_y = np.random.randint(-int(ratio*w), int(ratio*w))
+    delta_x = np.random.randint(-int(ratio * w), int(ratio * w))
+    delta_y = np.random.randint(-int(ratio * w), int(ratio * w))
     bbox[0] -= delta_x
     bbox[2] -= delta_x
     bbox[1] -= delta_y
     bbox[3] -= delta_y
     bbox = square_box(img_pil, bbox)
     return bbox
 
 
 def random_rotate_with_box(img_pil, box, rot_range=[-10, 10], debug=False):
     minn = rot_range[0]
     maxx = rot_range[1]
     x, y, xx, yy = box
-    center_x = (x + xx)//2
-    center_y = (y + yy)//2
-    img_pil = img_pil.rotate(np.random.randint(
-        minn, maxx), center=(center_x, center_y))
+    center_x = (x + xx) // 2
+    center_y = (y + yy) // 2
+    img_pil = img_pil.rotate(np.random.randint(minn, maxx), center=(center_x, center_y))
     img_pil_draw = ImageDraw.Draw(img_pil)
     if debug:
         img_pil_draw.rectangle(([x, y, xx, yy]))
     return img_pil
 
 
 def blend_imgs(src1, src2, alpha=0.5):
```

## mipkit/logger.py

```diff
@@ -1,38 +1,40 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
-import warnings
 import logging
+import warnings
+
 try:
-    from termcolor import cprint, colored
+    from termcolor import colored, cprint
 except ImportError as e:
     warnings.warn(e.msg)
 
+
 def get_logger():
     logger = logging.getLogger()
     logger.setLevel(level=logging.INFO)
     formatter = logging.Formatter(
         "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
     )
     ch = logging.StreamHandler()
```

## mipkit/pdf.py

```diff
@@ -1,20 +1,22 @@
-import six
-import pkg_resources
-import sys
-import re
 import argparse
 import os
+import re
+import sys
+
+import pkg_resources
+import six
 from tqdm import tqdm
+
 from .helpers import install_and_import
 
-install_and_import('PyDF2')
+install_and_import("PyDF2")
 from PyPDF2 import PdfFileReader, PdfFileWriter
-from PyPDF2.pdf import PageObject
 from PyPDF2.generic import FloatObject
+from PyPDF2.pdf import PageObject
 
 __VERSION__ = "1.0.0"
 
 
 def version():
     return __VERSION__
```

## mipkit/pl_utils.py

```diff
@@ -1,58 +1,52 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 from argparse import ArgumentParser, Namespace
-from .utils import load_yaml_config
-from .logger import print_info
+
 from .helpers import install_and_import
+from .logger import print_info
+from .utils import load_yaml_config
 
-install_and_import('pytorch_lightning')
+install_and_import("pytorch_lightning")
 import pytorch_lightning as pl
 
+
 def parse_args(add_pl_args=True, is_notebook=False, print_args=True):
     parser = ArgumentParser()
 
     # ===============================================================================
     # Training Arguments
     # ===============================================================================
-    parser.add_argument("--mode",
-                        choices=["train", "test"],
-                        type=str,
-                        default="train")
-    parser.add_argument("-c",
-                        "--config_file",
-                        type=str,
-                        help="configuration file")
-    parser.add_argument("-j",
-                        "--num_workers",
-                        type=int,
-                        default=8,
-                        help="number of workers")
+    parser.add_argument("--mode", choices=["train", "test"], type=str, default="train")
+    parser.add_argument("-c", "--config_file", type=str, help="configuration file")
+    parser.add_argument(
+        "-j", "--num_workers", type=int, default=8, help="number of workers"
+    )
 
     # ===============================================================================
     # Learing Rate and Scheduler
     # ===============================================================================
     parser.add_argument("--debug", action="store_true", help="debug")
 
     parser.add_argument(
@@ -70,18 +64,17 @@
     )
 
     parser.add_argument("--seed", type=int, default=2021, help="random seed")
 
     # ===============================================================================
     # Testing
     # ===============================================================================
-    parser.add_argument("--resume_ckpt",
-                        type=str,
-                        default=None,
-                        help="resuming checkpoint")
+    parser.add_argument(
+        "--resume_ckpt", type=str, default=None, help="resuming checkpoint"
+    )
 
     if add_pl_args:
         parser = pl.Trainer.add_argparse_args(parser)
     else:
         parser.add_argument("--gpus", type=int, help="Number of GPUS")
 
     # Generate args
@@ -93,17 +86,17 @@
     config_args = load_yaml_config(args.config_file, to_args=True, mode=1)
 
     # Load arguments from Pytorch Lightining
     args = vars(args)
 
     # Load arguments from configuration file
     args.update(vars(config_args))
-    
+
     args = Namespace(**args)
     # args = Namespace(**vars(args), **vars(config_args))
 
     if print_args:
-        print('=================================================')
-        print_info('Arguments:')
+        print("=================================================")
+        print_info("Arguments:")
         print(args)
-        print('=================================================')
-    return args
+        print("=================================================")
+    return args
```

## mipkit/stats.py

```diff
@@ -1,36 +1,37 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 import warnings
+
 try:
     import numpy as np
-    
+
 except ImportError as e:
     warnings.warn(e.msg)
 
 
 def show_stats(np_arr, return_stats=False, verbose=True):
     assert isinstance(np_arr, np.ndarray)
     stats = {}
```

## mipkit/utils.py

```diff
@@ -1,43 +1,44 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
-import os
+import argparse
 import copy
-import time
-import yaml
 import json
+import os
+import time
 import warnings
-import argparse
-import numpy as np
-from glob import glob
+from collections import OrderedDict
 from datetime import datetime
+from glob import glob
 from pathlib import Path
-from collections import OrderedDict
+
+import numpy as np
+import yaml
 
 try:
     from tqdm import tqdm as _tqdm
 except ImportError as e:
     warnings.warn(e.msg)
 
 
@@ -114,14 +115,15 @@
 
 # ===============================================================================
 # Argparse
 # ===============================================================================
 
 
 class ArgSpace(dict):
+
     def __getattr__(self, attr):
         if attr == "__getstate__":
             return super(DD, self).__getstate__
         elif attr == "__setstate__":
             return super(DD, self).__setstate__
         elif attr == "__slots__":
             return super(DD, self).__slots__
@@ -284,15 +286,22 @@
     """Split a given sequence into `k` parts."""
     length = len(seq)
     if length % k != 0:
         add_last = length % k
     else:
         add_last = 0
     n_items = length // k
-    return [seq[i * n_items : (i * n_items + n_items + add_last) if i==(k-1) else (i * n_items + n_items)] for i in range(k)]
+    return [
+        seq[
+            i * n_items : (i * n_items + n_items + add_last)
+            if i == (k - 1)
+            else (i * n_items + n_items)
+        ]
+        for i in range(k)
+    ]
 
 
 def to_str_with_pad(number, n_char=0, pad_value=0):
     """Convert number to string representation with zero padding.
 
     Args:
         i (int): number.
```

## mipkit/video.py

```diff
@@ -1,17 +1,17 @@
-
-from typing import Tuple, Dict, List
 import warnings
+from typing import Dict, List, Tuple
 
 try:
     import cv2
     import numpy as np
 except ImportError as e:
     warnings.warn(e.msg)
 
+
 def load_video(video_file: str) -> Tuple["videocapture", Tuple[int, int], int, int]:
     """Load a video from the specified file.
 
     Args:
         video_file (str): a path to video file.
 
     Returns:
@@ -24,38 +24,38 @@
     width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
     height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
     num_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
     fps = int(cap.get(cv2.CAP_PROP_FPS))
     return cap, (width, height), num_frames, fps
 
 
-def get_frame_by_idx(cap: "VideoCapture", idx: str='middle') -> "ndarray":
+def get_frame_by_idx(cap: "VideoCapture", idx: str = "middle") -> "ndarray":
     if not isinstance(idx, int):
-        assert idx in ['middle', 'first', 'last']
+        assert idx in ["middle", "first", "last"]
 
     num_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
-    if idx == 'middle':
+    if idx == "middle":
         idx = num_frames // 2
-    elif idx == 'first':
+    elif idx == "first":
         idx = 0
-    elif idx == 'last':
+    elif idx == "last":
         idx = num_frames - 1
     if idx > num_frames:
-        raise ValueError('`frame_idx` must be less than a number of frames')
+        raise ValueError("`frame_idx` must be less than a number of frames")
 
     return_frames = None
 
     cap.set(cv2.CAP_PROP_POS_FRAMES, idx)
     has_frame, return_frames = cap.read()
     # Convert from BGR to RGB
     return_frames = cv2.cvtColor(return_frames, cv2.COLOR_BGR2RGB)
     return return_frames
 
 
-def get_frames_by_FPS(cap: "VideoCapture", fps: int=1) -> List["ndarray"]:
+def get_frames_by_FPS(cap: "VideoCapture", fps: int = 1) -> List["ndarray"]:
     """Get frames from video given by FPS and
 
     Args:
         cap (cv2.VideoCapture): VideoCapture instance
         fps (int, optional): Frame per sec. Defaults to 1.
 
     Returns:
```

## mipkit/vis.py

```diff
@@ -1,45 +1,46 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
-
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
-
- Provided license texts might have their own copyrights and restrictions
-
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 import os
 import warnings
+
 try:
-    import matplotlib.pyplot as plt
-    from matplotlib import gridspec
     import cv2
+    import matplotlib.pyplot as plt
     import numpy as np
     import pylab
+    from matplotlib import gridspec
 except ImportError as e:
     warnings.warn(e.msg)
 
 from .images import read_image
-from .utils import deprecated, NotFoundWarning
+from .utils import NotFoundWarning, deprecated
 
 TEXT_COLOR = (255, 255, 255)
 
 
 def import_matplotlib():
     plt.rcParams["figure.figsize"] = (8, 8)
     plt.rcParams["figure.dpi"] = 125
```

## mipkit/dl/__init__.py

```diff
@@ -1,28 +1,28 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
+from . import metrics
 from .summary import summary, summary_string
 from .utils import *
-from . import metrics
```

## mipkit/dl/losses.py

```diff
@@ -1,83 +1,92 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 import torch
 from torch.nn.modules.loss import _Loss
+
 # torch.set_printoptions(precision=4, sci_mode=False, linewidth=150)
 
 
 class FocalBCE(_Loss):
     # https://www.kaggle.com/thedrcat/focal-multilabel-loss-in-pytorch-explained
     def __init__(self, gamma=2, *args, **kwargs):
         super(FocalBCE, self).__init__(*args, **kwargs)
         self.gamma = gamma
 
     def forward(self, input, target):
         num_classes = target.size(1)
         l = input.reshape(-1)
         t = target.reshape(-1)
         p = torch.sigmoid(l)
-        p = torch.where(t >= 0.5, p, 1-p)
-        logp = - torch.log(torch.clamp(p, 1e-4, 1-1e-4))
-        loss = logp*((1-p)**self.gamma)
-        loss = num_classes*loss
+        p = torch.where(t >= 0.5, p, 1 - p)
+        logp = -torch.log(torch.clamp(p, 1e-4, 1 - 1e-4))
+        loss = logp * ((1 - p) ** self.gamma)
+        loss = num_classes * loss
 
-        if self.reduction == 'mean' or self.reduction is None:
+        if self.reduction == "mean" or self.reduction is None:
             return loss.mean()
-        elif self.reduction == 'sum':
+        elif self.reduction == "sum":
             return loss.sum()
 
 
 class CCCLoss(_Loss):
+
     def __init__(self, *args, **kwargs):
         super(CCCLoss, self).__init__()
 
     def forward(self, input, target, seq_lens=None):
         if seq_lens is not None:
             mask = torch.ones_like(target, device=target.device)
             for i, seq_len in enumerate(seq_lens):
                 mask[i, seq_len:] = 0
         else:
             mask = torch.ones_like(target, device=target.device)
 
-        target_mean = torch.sum(
-            target * mask, dim=1, keepdim=True) / torch.sum(mask, dim=1, keepdim=True)
-        input_mean = torch.sum(
-            input * mask, dim=1, keepdim=True) / torch.sum(mask, dim=1, keepdim=True)
-
-        target_var = torch.sum(mask * (target - target_mean) ** 2, dim=1, keepdim=True) / torch.sum(mask, dim=1,
-                                                                                                    keepdim=True)
-        input_var = torch.sum(mask * (input - input_mean) ** 2, dim=1, keepdim=True) / torch.sum(mask, dim=1,
-                                                                                                 keepdim=True)
-
-        cov = torch.sum(mask * (target - target_mean) * (input - input_mean), dim=1, keepdim=True) \
-            / torch.sum(mask, dim=1, keepdim=True)
-
-        ccc = torch.mean(2.0 * cov / (target_var + input_var +
-                                      (target_mean - input_mean) ** 2), dim=0)
+        target_mean = torch.sum(target * mask, dim=1, keepdim=True) / torch.sum(
+            mask, dim=1, keepdim=True
+        )
+        input_mean = torch.sum(input * mask, dim=1, keepdim=True) / torch.sum(
+            mask, dim=1, keepdim=True
+        )
+
+        target_var = torch.sum(
+            mask * (target - target_mean) ** 2, dim=1, keepdim=True
+        ) / torch.sum(mask, dim=1, keepdim=True)
+        input_var = torch.sum(
+            mask * (input - input_mean) ** 2, dim=1, keepdim=True
+        ) / torch.sum(mask, dim=1, keepdim=True)
+
+        cov = torch.sum(
+            mask * (target - target_mean) * (input - input_mean), dim=1, keepdim=True
+        ) / torch.sum(mask, dim=1, keepdim=True)
+
+        ccc = torch.mean(
+            2.0 * cov / (target_var + input_var + (target_mean - input_mean) ** 2),
+            dim=0,
+        )
         ccc = ccc.squeeze(0)
         ccc_loss = 1.0 - ccc
 
         return ccc_loss
```

## mipkit/dl/metrics.py

```diff
@@ -1,30 +1,30 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 
 import scipy.stats as scs
 
 
 def pearsonr(x, y, dim):
```

## mipkit/dl/summary.py

```diff
@@ -1,65 +1,69 @@
 # This package is inspired from `https://github.com/sksq96/pytorch-summary/blob/master/torchsummary/torchsummary.py``
 import typing
-import torch
-import torch.nn as nn
 from collections import OrderedDict
+
 import numpy as np
+import torch
+import torch.nn as nn
 
 
-def summary(model: nn.Module,
-            input_size: typing.List,
-            batch_size=-1,
-            device=torch.device('cuda:0'),
-            dtypes=None):
-    result, params_info = summary_string(model, input_size, batch_size, device,
-                                         dtypes)
+def summary(
+    model: nn.Module,
+    input_size: typing.List,
+    batch_size=-1,
+    device=torch.device("cuda:0"),
+    dtypes=None,
+):
+    result, params_info = summary_string(model, input_size, batch_size, device, dtypes)
     print(result)
 
     return params_info
 
 
-def summary_string(model: nn.Module,
-                   input_size: typing.List,
-                   batch_size: int = -1,
-                   device: torch.DeviceObjType = torch.device('cuda'),
-                   dtypes: torch.TensorType = None):
+def summary_string(
+    model: nn.Module,
+    input_size: typing.List,
+    batch_size: int = -1,
+    device: torch.DeviceObjType = torch.device("cuda"),
+    dtypes: torch.TensorType = None,
+):
     if dtypes == None:
         dtypes = [torch.FloatTensor] * len(input_size)
 
-    summary_str = ''
+    summary_str = ""
 
     def register_hook(module):
         def hook(module, input, output):
             class_name = str(module.__class__).split(".")[-1].split("'")[0]
             module_idx = len(summary)
 
             m_key = "%s-%i" % (class_name, module_idx + 1)
             summary[m_key] = OrderedDict()
             summary[m_key]["input_shape"] = list(input[0].size())
             summary[m_key]["input_shape"][0] = batch_size
             if isinstance(output, (list, tuple)):
-                summary[m_key]["output_shape"] = [[-1] + list(o.size())[1:]
-                                                  for o in output]
+                summary[m_key]["output_shape"] = [
+                    [-1] + list(o.size())[1:] for o in output
+                ]
             else:
                 summary[m_key]["output_shape"] = list(output.size())
                 summary[m_key]["output_shape"][0] = batch_size
 
             params = 0
             if hasattr(module, "weight") and hasattr(module.weight, "size"):
-                params += torch.prod(
-                    torch.LongTensor(list(module.weight.size())))
+                params += torch.prod(torch.LongTensor(list(module.weight.size())))
                 summary[m_key]["trainable"] = module.weight.requires_grad
             if hasattr(module, "bias") and hasattr(module.bias, "size"):
-                params += torch.prod(torch.LongTensor(list(
-                    module.bias.size())))
+                params += torch.prod(torch.LongTensor(list(module.bias.size())))
             summary[m_key]["nb_params"] = params
 
-        if (not isinstance(module, nn.Sequential)
-                and not isinstance(module, nn.ModuleList)):
+        if not isinstance(module, nn.Sequential) and not isinstance(
+            module, nn.ModuleList
+        ):
             hooks.append(module.register_forward_hook(hook))
 
     # multiple inputs to the network
     if isinstance(input_size, tuple):
         input_size = [input_size]
 
     # batch_size of 2 for batchnorm
@@ -79,19 +83,22 @@
     # print(x.shape)
     model(*x)
 
     # remove these hooks
     for h in hooks:
         h.remove()
 
-    summary_str += "----------------------------------------------------------------" + "\n"
-    line_new = "{:>20}  {:>25} {:>15}".format("Layer (type)", "Output Shape",
-                                              "Param #")
+    summary_str += (
+        "----------------------------------------------------------------" + "\n"
+    )
+    line_new = "{:>20}  {:>25} {:>15}".format("Layer (type)", "Output Shape", "Param #")
     summary_str += line_new + "\n"
-    summary_str += "================================================================" + "\n"
+    summary_str += (
+        "================================================================" + "\n"
+    )
     total_params = 0
     total_output = 0
     trainable_params = 0
     for layer in summary:
         # input_shape, output_shape, trainable, nb_params
         line_new = "{:>20}  {:>25} {:>15}".format(
             layer,
@@ -104,26 +111,35 @@
         if "trainable" in summary[layer]:
             if summary[layer]["trainable"] == True:
                 trainable_params += summary[layer]["nb_params"]
         summary_str += line_new + "\n"
 
     # assume 4 bytes/number (float on cuda).
     total_input_size = abs(
-        np.prod(sum(input_size, ())) * batch_size * 4. / (1024**2.))
-    total_output_size = abs(2. * total_output * 4. /
-                            (1024**2.))  # x2 for gradients
-    total_params_size = abs(total_params * 4. / (1024**2.))
+        np.prod(sum(input_size, ())) * batch_size * 4.0 / (1024**2.0)
+    )
+    total_output_size = abs(
+        2.0 * total_output * 4.0 / (1024**2.0)
+    )  # x2 for gradients
+    total_params_size = abs(total_params * 4.0 / (1024**2.0))
     total_size = total_params_size + total_output_size + total_input_size
 
-    summary_str += "================================================================" + "\n"
+    summary_str += (
+        "================================================================" + "\n"
+    )
     summary_str += "Total params: {0:,}".format(total_params) + "\n"
     summary_str += "Trainable params: {0:,}".format(trainable_params) + "\n"
-    summary_str += "Non-trainable params: {0:,}".format(
-        total_params - trainable_params) + "\n"
-    summary_str += "----------------------------------------------------------------" + "\n"
+    summary_str += (
+        "Non-trainable params: {0:,}".format(total_params - trainable_params) + "\n"
+    )
+    summary_str += (
+        "----------------------------------------------------------------" + "\n"
+    )
     summary_str += "Input size (MB): %0.2f" % total_input_size + "\n"
     summary_str += "Forward/backward pass size (MB): %0.2f" % total_output_size + "\n"
     summary_str += "Params size (MB): %0.2f" % total_params_size + "\n"
     summary_str += "Estimated Total Size (MB): %0.2f" % total_size + "\n"
-    summary_str += "----------------------------------------------------------------" + "\n"
+    summary_str += (
+        "----------------------------------------------------------------" + "\n"
+    )
     # return summary
     return summary_str, (total_params, trainable_params)
```

## mipkit/dl/tune.py

```diff
@@ -1,124 +1,121 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 import os
+
 from ray import tune
 from ray.tune import CLIReporter, logger
-from ray.tune.schedulers import ASHAScheduler, PopulationBasedTraining
 from ray.tune.integration.pytorch_lightning import TuneReportCallback
+from ray.tune.schedulers import ASHAScheduler, PopulationBasedTraining
 from tensorboard import program
 
 
 def run_tensorboard(log_dir, host, port):
     """Run tensorboard as a daemon process
 
     Args:
         log_dir (str): log directory.
-        host (str): tensorboard host 
-        port (str): tensorboard port 
+        host (str): tensorboard host
+        port (str): tensorboard port
 
     Returns:
         str: url of tensorboard server
     """
 
     tb = program.TensorBoard()
-    tb.configure(argv=[None, '--logdir', log_dir,
-                       '--port', port, '--host', host])
+    tb.configure(argv=[None, "--logdir", log_dir, "--port", port, "--host", host])
     url = tb.launch()
-    print(f'Tensorboard started at {url}')
+    print(f"Tensorboard started at {url}")
     return url
 
 
-def start_tuning(train_config: dict,
-                 tuning_config: dict,
-                 training_func,
-                 experiment_name: str,
-                 report_metric_columns: list,
-                 monitor_metric: str,
-                 monitor_mode: str,
-                 num_epochs: int = 40,
-                 num_samples: int = 10,
-                 gpus_per_trial: int = 1,
-                 cpus_per_trial: int = 1,
-                 log_dir: str = '.',
-                 tb_port: str = '6006',
-                 tb_host: str = '0.0.0.0',
-                 run_tb: bool = False):
+def start_tuning(
+    train_config: dict,
+    tuning_config: dict,
+    training_func,
+    experiment_name: str,
+    report_metric_columns: list,
+    monitor_metric: str,
+    monitor_mode: str,
+    num_epochs: int = 40,
+    num_samples: int = 10,
+    gpus_per_trial: int = 1,
+    cpus_per_trial: int = 1,
+    log_dir: str = ".",
+    tb_port: str = "6006",
+    tb_host: str = "0.0.0.0",
+    run_tb: bool = False,
+):
     # ===============================================================================
     # Configuration
     # ===============================================================================
 
     log_path = os.path.join(log_dir, experiment_name)
 
-    scheduler = ASHAScheduler(
-        max_t=num_epochs,
-        grace_period=1,
-        reduction_factor=2)
+    scheduler = ASHAScheduler(max_t=num_epochs, grace_period=1, reduction_factor=2)
 
     # scheduler = PopulationBasedTraining(
     #     time_attr="training_iteration",
     #     metric=monitor_metric,
     #     mode=monitor_mode,
     #     perturbation_interval=4,
     #     hyperparam_mutations={
     #         "lr": lambda: tune.loguniform(1e-4, 1e-1).func(None),
     #         "batch_size": [32, 64, 128]
     #     })
 
     reporter = CLIReporter(
         parameter_columns=list(tuning_config.keys()),
-        metric_columns=report_metric_columns)
+        metric_columns=report_metric_columns,
+    )
 
     # ===============================================================================
     # Tensorboard
     # ===============================================================================
     if run_tb:
         run_tensorboard(log_path, host=tb_host, port=tb_port)
 
     # ===============================================================================
     # Tune Run
     # ===============================================================================
     analysis = tune.run(
-        tune.with_parameters(
-            training_func, **train_config),
-        resources_per_trial={
-            "cpu": cpus_per_trial,
-            "gpu": gpus_per_trial
-        },
+        tune.with_parameters(training_func, **train_config),
+        resources_per_trial={"cpu": cpus_per_trial, "gpu": gpus_per_trial},
         metric=monitor_metric,
         mode=monitor_mode,
         config=tuning_config,
         num_samples=num_samples,
         scheduler=scheduler,
         progress_reporter=reporter,
         name=experiment_name,
         verbose=1,
-        local_dir=log_dir)
+        local_dir=log_dir,
+    )
 
     print("Best hyperparameters found were: ", analysis.best_config)
-    analysis.results_df.to_csv(os.path.join(log_path, 'results.csv'),
-                               index=False)
-    analysis.best_result_df.to_csv(os.path.join(log_path, 'best_results.csv'),
-                                   index=False)
+    analysis.results_df.to_csv(os.path.join(log_path, "results.csv"), index=False)
+    analysis.best_result_df.to_csv(
+        os.path.join(log_path, "best_results.csv"), index=False
+    )
```

## mipkit/faces/__init__.py

```diff
@@ -1,27 +1,27 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 from .faces_utils import *
-from .helpers import *
+from .helpers import *
```

## mipkit/faces/faces_utils.py

```diff
@@ -1,44 +1,48 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-from .helpers import FACIAL_LANDMARKS_68_IDXS
-from .helpers import FACIAL_LANDMARKS_5_IDXS
-import numpy as np
-import cv2
 import warnings
 
+import cv2
+import numpy as np
+
+from .helpers import FACIAL_LANDMARKS_5_IDXS, FACIAL_LANDMARKS_68_IDXS
+
 
-def face_align(image, landmarks,
-               desiredLeftEye=(0.35, 0.35),
-               desiredFaceWidth=256,
-               desiredFaceHeight=256):
-    if (len(landmarks) == 68):
+def face_align(
+    image,
+    landmarks,
+    desiredLeftEye=(0.35, 0.35),
+    desiredFaceWidth=256,
+    desiredFaceHeight=256,
+):
+    if len(landmarks) == 68:
         # extract the left and right eye (x, y)-coordinates
         (lStart, lEnd) = FACIAL_LANDMARKS_68_IDXS["left_eye"]
         (rStart, rEnd) = FACIAL_LANDMARKS_68_IDXS["right_eye"]
     else:
         (lStart, lEnd) = FACIAL_LANDMARKS_5_IDXS["left_eye"]
         (rStart, rEnd) = FACIAL_LANDMARKS_5_IDXS["right_eye"]
 
@@ -58,33 +62,34 @@
     # desired x-coordinate of the left eye
     desiredRightEyeX = 1.0 - desiredLeftEye[0]
 
     # determine the scale of the new resulting image by taking
     # the ratio of the distance between eyes in the *current*
     # image to the ratio of distance between eyes in the
     # *desired* image
-    dist = np.sqrt((dX ** 2) + (dY ** 2))
-    desiredDist = (desiredRightEyeX - desiredLeftEye[0])
+    dist = np.sqrt((dX**2) + (dY**2))
+    desiredDist = desiredRightEyeX - desiredLeftEye[0]
     desiredDist *= desiredFaceWidth
     scale = desiredDist / dist
 
     # compute center (x, y)-coordinates (i.e., the median point)
     # between the two eyes in the input image
-    eyesCenter = ((leftEyeCenter[0] + rightEyeCenter[0]) // 2,
-                  (leftEyeCenter[1] + rightEyeCenter[1]) // 2)
+    eyesCenter = (
+        (leftEyeCenter[0] + rightEyeCenter[0]) // 2,
+        (leftEyeCenter[1] + rightEyeCenter[1]) // 2,
+    )
 
     # grab the rotation matrix for rotating and scaling the face
     M = cv2.getRotationMatrix2D(eyesCenter, angle, scale)
 
     # update the translation component of the matrix
     tX = desiredFaceWidth * 0.5
     tY = desiredFaceHeight * desiredLeftEye[1]
-    M[0, 2] += (tX - eyesCenter[0])
-    M[1, 2] += (tY - eyesCenter[1])
+    M[0, 2] += tX - eyesCenter[0]
+    M[1, 2] += tY - eyesCenter[1]
 
     # apply the affine transformation
     (w, h) = (desiredFaceWidth, desiredFaceHeight)
-    output = cv2.warpAffine(image, M, (w, h),
-                            flags=cv2.INTER_CUBIC)
+    output = cv2.warpAffine(image, M, (w, h), flags=cv2.INTER_CUBIC)
 
     # return the aligned face
     return output
```

## mipkit/faces/helpers.py

```diff
@@ -1,44 +1,42 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 from collections import OrderedDict
 
 FACIAL_LANDMARKS_68_IDXS = OrderedDict([
     ("mouth", (48, 68)),
     ("inner_mouth", (60, 68)),
     ("right_eyebrow", (17, 22)),
     ("left_eyebrow", (22, 27)),
     ("right_eye", (36, 42)),
     ("left_eye", (42, 48)),
     ("nose", (27, 36)),
-    ("jaw", (0, 17))
+    ("jaw", (0, 17)),
 ])
 
 # For dlibs 5-point facial landmark detector:
-FACIAL_LANDMARKS_5_IDXS = OrderedDict([
-    ("right_eye", (2, 3)),
-    ("left_eye", (0, 1)),
-    ("nose", (4))
-])
+FACIAL_LANDMARKS_5_IDXS = OrderedDict(
+    [("right_eye", (2, 3)), ("left_eye", (0, 1)), ("nose", (4))]
+)
```

## mipkit/ip/__init__.py

```diff
@@ -1,26 +1,26 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-__doc__ = """This package is a implementation of Image Processing homeworks"""
+__doc__ = """This package is a implementation of Image Processing homeworks"""
```

## mipkit/ip/fft.py

```diff
@@ -1,39 +1,39 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-import numpy as np
 import cv2
+import numpy as np
 
 
 def fft(img: np.ndarray, is_shift=True, use_cv2=True):
     """Fourier transform the image and return the frequency matrix after transposition"""
-    assert img.ndim == 2, 'img should be gray.'
+    assert img.ndim == 2, "img should be gray."
     rows, cols = img.shape[:2]
 
     # Calculate the optimal size
     nrows = cv2.getOptimalDFTSize(rows)
     ncols = cv2.getOptimalDFTSize(cols)
 
     # According to the new size, create a new transformed image
@@ -56,25 +56,25 @@
         return fft_mat, rows, cols
 
 
 def to_fft_image(fft_mat, is_shift=False):
     """Convert frequency matrix to visual image"""
     if is_shift:
         fft_mat = np.fft.fftshift(fft_mat)
-    log_mat = 20*np.log(np.abs(fft_mat))
+    log_mat = 20 * np.log(np.abs(fft_mat))
     return np.uint8(np.around(log_mat))
 
 
 def ifft(fft_mat, rows, cols):
     """Inverse Fourier transform, return inverse transform image
 
     Args:
         fft_mat (ndarray]): fft matrix
         rows (int): the height of the original image
-        cols (int): the width of the original image 
+        cols (int): the width of the original image
 
     Returns:
         ndarray: inversed image
     """
 
     # Reverse transposition, the low frequency part moves to the surrounding, the high frequency part moves to the middle
     f_ishift_mat = np.fft.ifftshift(fft_mat)
@@ -84,18 +84,16 @@
     img_back = np.uint8(np.clip(img_back, 0, 255))
     img_back = img_back[:rows, :cols]
     return img_back
 
 
 def fft_distances(m, n):
     """Calculate the distance of each point of the m, n matrix from the center"""
-    u = np.array([i if i <= m / 2 else m - i for i in range(m)],
-                 dtype=np.float32)
-    v = np.array([i if i <= m / 2 else m - i for i in range(m)],
-                 dtype=np.float32)
+    u = np.array([i if i <= m / 2 else m - i for i in range(m)], dtype=np.float32)
+    v = np.array([i if i <= m / 2 else m - i for i in range(m)], dtype=np.float32)
     v.shape = n, 1
 
     # The distance from each point to the upper left corner of the matrix
     ret = np.sqrt(u * u + v * v)
 
     # The distance of each point from the center of the matrix
     return np.fft.fftshift(ret)
```

## mipkit/ip/freq_filters.py

```diff
@@ -1,45 +1,44 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-from .fft import fft_distances
-import numpy as np
 import cv2
+import numpy as np
+
+from .fft import fft_distances
 
 
 def get_H(m, n):
     """Calculate the distance of each point of the m, n matrix from the center"""
-    u = np.array([i if i <= m / 2 else m - i for i in range(m)],
-                 dtype=np.float32)
-    v = np.array([i if i <= m / 2 else m - i for i in range(m)],
-                 dtype=np.float32)
+    u = np.array([i if i <= m / 2 else m - i for i in range(m)], dtype=np.float32)
+    v = np.array([i if i <= m / 2 else m - i for i in range(m)], dtype=np.float32)
     v.shape = n, 1
-    return (u - m/2)**2 + (v - n/2)**2
+    return (u - m / 2) ** 2 + (v - n / 2) ** 2
 
 
 def laplacian_filter(fft_mat, d0=10, r1=0.5, rh=2, c=4, h=2.0, l=0.5):
     """Homomorphic Filter
 
     Args:
         fft_mat (ndarray): fft matrix
@@ -52,16 +51,17 @@
 
     Returns:
         nd]: [description]
     """
     rows, cols = fft_mat.shape[:2]
 
     Huv = np.zeros_like(fft_mat)
-    M, N = np.meshgrid(np.arange(-cols // 2, cols // 2),
-                       np.arange(-rows//2, rows//2))
+    M, N = np.meshgrid(
+        np.arange(-cols // 2, cols // 2), np.arange(-rows // 2, rows // 2)
+    )
     # Huv = -((M - M//2) ** 2 + (N - N//2) ** 2)
     Huv = get_H(rows, cols)
 
     print(Huv)
     # Gaussian high-pass filter
     # Z = (rh - r1) * (1 - np.exp(-c * (Duv ** 2 / d0 ** 2))) + r1
 
@@ -86,20 +86,21 @@
 
     Returns:
         nd]: [description]
     """
     rows, cols = fft_mat.shape[:2]
 
     Huv = np.zeros_like(fft_mat)
-    M, N = np.meshgrid(np.arange(-cols // 2, cols // 2),
-                       np.arange(-rows//2, rows//2))
-    Duv = np.sqrt(M ** 2 + N ** 2)
+    M, N = np.meshgrid(
+        np.arange(-cols // 2, cols // 2), np.arange(-rows // 2, rows // 2)
+    )
+    Duv = np.sqrt(M**2 + N**2)
 
     # Gaussian high-pass filter
-    Z = (rh - r1) * (1 - np.exp(-c * (Duv ** 2 / d0 ** 2))) + r1
+    Z = (rh - r1) * (1 - np.exp(-c * (Duv**2 / d0**2))) + r1
 
     # Z =  (1 - np.exp(-c * (Duv ** 2 / d0 ** 2)))
     Huv = Z * fft_mat
 
     Huv = (h - l) * Huv + l
     return Huv
 
@@ -117,27 +118,26 @@
         cols (int): the width of the filtered matrix
         d0 (int): filter size d0
         n (int): order of Butterworth low-pass filtering
 
     Returns:
         ndarray: filter matrix
     """
-    assert d0 > 0, 'd0 should be more than 0.'
+    assert d0 > 0, "d0 should be more than 0."
     filter_mat = None
 
     if rows is None and cols is None:
         rows, cols = fft_mat.shape[:2]
     else:
         assert rows is not None and cols is not None
 
     # Ideal low-pass filtering
     if flag == 0:
         filter_mat = np.zeros((rows, cols, 2), np.float32)
-        cv2.circle(filter_mat, (rows // 2, cols // 2),
-                   d0, (1, 1, 1), thickness=-1)
+        cv2.circle(filter_mat, (rows // 2, cols // 2), d0, (1, 1, 1), thickness=-1)
 
     # Butterworth low-pass filtering
     elif flag == 1:
         duv = fft_distances(*fft_mat.shape[:2])
         filter_mat = 1 / (1 + np.power(duv / d0, 2 * n))
         # fft_mat has 2 channels, real and imaginary
         # fliter_mat also requires 2 channels
@@ -155,40 +155,39 @@
     return filtered_mat
 
 
 def hpfilter(fft_mat, flag, d0, n, rows=None, cols=None):
     """High-pass filter
 
     Args:
-        fft_mat (ndarray): fft matrix   
+        fft_mat (ndarray): fft matrix
         flag (int): filter type
             0-ideal high-pass filtering
             1-Butterworth high-pass filtering
             2-Gaussian high-pass filtering
         rows (int): the height of the filtered matrix
         cols (int): the width of the filtered matrix
         d0 (int): filter size d0
         n (int): the order of Butterworth high-pass filtering
 
     Returns:
         ndarray: filter matrix b
     """
-    assert d0 > 0, 'd0 should be more than 0.'
+    assert d0 > 0, "d0 should be more than 0."
     filter_mat = None
 
     if rows is None and cols is None:
         rows, cols = fft_mat.shape[:2]
     else:
         assert rows is not None and cols is not None
 
     # Ideal high-pass filtering
     if flag == 0:
         filter_mat = np.ones((rows, cols, 2), np.float32)
-        cv2.circle(filter_mat, (rows // 2, cols // 2),
-                   d0, (0, 0, 0), thickness=-1)
+        cv2.circle(filter_mat, (rows // 2, cols // 2), d0, (0, 0, 0), thickness=-1)
 
     # Butterworth high-pass filtering
     elif flag == 1:
         duv = fft_distances(rows, cols)
         # duv has a value of 0 (the center is 0 from the center). To avoid division by 0, set the center to 0.000001
         duv[rows // 2, cols // 2] = 0.000001
         filter_mat = 1 / (1 + np.power(d0 / duv, 2 * n))
@@ -217,30 +216,38 @@
             When axis = 0, the images are merged vertically;
             When axis = 1, the images are merged horizontally.
     Returns:
         merge image
     """
     ndim = images[0].ndim
     shapes = np.array([mat.shape for mat in images])
-    assert np.all(map(lambda e: len(e) == ndim, shapes)
-                  ), 'all images should be same ndim.'
+    assert np.all(
+        map(lambda e: len(e) == ndim, shapes)
+    ), "all images should be same ndim."
     if axis == 0:  # merge images vertically
-
         # Merge image cols
         cols = np.max(shapes[:, 1])
 
         # Expand the cols size of each image to make the cols consistent
-        copy_imgs = [cv2.copyMakeBorder(img, 0, 0, 0, cols - img.shape[1],
-                                        cv2.BORDER_CONSTANT, (0, 0, 0)) for img in images]
+        copy_imgs = [
+            cv2.copyMakeBorder(
+                img, 0, 0, 0, cols - img.shape[1], cv2.BORDER_CONSTANT, (0, 0, 0)
+            )
+            for img in images
+        ]
         # Merge vertically
         return np.vstack(copy_imgs)
 
     else:  # merge images horizontally
         # Combine the rows of the image
         rows = np.max(shapes[:, 0])
 
         # Expand the row size of each image to make rows consistent
-        copy_imgs = [cv2.copyMakeBorder(img, 0, rows - img.shape[0], 0, 0,
-                                        cv2.BORDER_CONSTANT, (0, 0, 0)) for img in images]
+        copy_imgs = [
+            cv2.copyMakeBorder(
+                img, 0, rows - img.shape[0], 0, 0, cv2.BORDER_CONSTANT, (0, 0, 0)
+            )
+            for img in images
+        ]
 
         # Merge horizontally
         return np.hstack(copy_imgs)
```

## mipkit/medical/__init__.py

```diff
@@ -1,33 +1,34 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 try:
     import itk
 except:
     raise ImportError(
-        "Cannot import `itk`. Please install the itk by `pip install itk`.")
+        "Cannot import `itk`. Please install the itk by `pip install itk`."
+    )
 
+from .itk_snap import *
 from .utils import *
 from .vis import *
-from .itk_snap import *
```

## mipkit/medical/itk_snap.py

```diff
@@ -1,14 +1,15 @@
 # /home/congvm/Applications/itksnap-3.8.0-20190612-Linux-gcc64/lib/snap-3.8.0/ITK-SNAP
 
-import subprocess
 import os
+import subprocess
+
 
+class ITKSnap:
 
-class ITKSnap():
     def __init__(self, itk_snap_bin_path, show_command=True):
         """ITK Wrapper
             -g FILE              : Load the main image from FILE
             -s FILE              : Load the segmentation image from FILE
             -l FILE              : Load label descriptions from FILE
             -o FILE [FILE+]      : Load additional images from FILE
                                 :   (multiple files may be provided)
@@ -17,28 +18,33 @@
         Args:
             itk_snap_path (str): path to ITK-Snap
         """
         assert os.path.isfile(itk_snap_bin_path)
         self.itk_snap_bin_path = itk_snap_bin_path
         self.show_command = show_command
 
-    def show(self, main_image_file_path, seg_image_file_path=None, add_main_image_file_path=None):
+    def show(
+        self,
+        main_image_file_path,
+        seg_image_file_path=None,
+        add_main_image_file_path=None,
+    ):
         assert os.path.isfile(main_image_file_path)
 
-        command = [self.itk_snap_bin_path, '-g', main_image_file_path]
+        command = [self.itk_snap_bin_path, "-g", main_image_file_path]
 
         if seg_image_file_path is not None:
             assert os.path.isfile(seg_image_file_path)
-            command.append('-s')
+            command.append("-s")
             command.append(seg_image_file_path)
 
         if add_main_image_file_path is not None:
             assert os.path.isfile(add_main_image_file_path)
-            command.append('-o')
+            command.append("-o")
             command.append(add_main_image_file_path)
 
         if self.show_command:
-            print('Command: ', ' '.join(command))
+            print("Command: ", " ".join(command))
 
-        process = subprocess.run(command,
-                                 stdout=subprocess.PIPE,
-                                 universal_newlines=True)
+        process = subprocess.run(
+            command, stdout=subprocess.PIPE, universal_newlines=True
+        )
```

## mipkit/medical/utils.py

```diff
@@ -1,39 +1,41 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
-
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
-
- Provided license texts might have their own copyrights and restrictions
-
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-import nibabel as nib
 import datetime
-from pydicom.dataset import FileDataset, FileMetaDataset
+
+import cv2
 import itk
-import SimpleITK as sitk
+import nibabel as nib
 import numpy as np
-import cv2
+import SimpleITK as sitk
+from pydicom.dataset import FileDataset, FileMetaDataset
+
 from ..utils import deprecated
 
 
 def flip_diagonally(x):
     """Diagonally flip all slides in a medical image
 
     Args:
@@ -44,15 +46,15 @@
     """
     #! TODO: Optimize process time
     x = cv2.rotate(x, cv2.ROTATE_90_CLOCKWISE)
     x = cv2.flip(x, 0)
     return x
 
 
-@deprecated('Please use `mipkit.medical.load_medical_image_file` instead')
+@deprecated("Please use `mipkit.medical.load_medical_image_file` instead")
 def load_nii_file(path_to_load: str):
     return load_medical_image_from_file(path_to_load)
 
 
 def load_medical_image_from_file(path_to_load: str, return_array_only=True):
     """Load medical file
 
@@ -108,27 +110,26 @@
     reader.SetFileNames(fileNames)
     reader.ForceOrthogonalDirectionOff()
     itk_image = reader.GetOutput()
     output_arr = itk.GetArrayFromImage(itk_image)
     return output_arr
 
 
-@ deprecated("Please use `mipkit.medical.save_medical_image_file` instead!")
+@deprecated("Please use `mipkit.medical.save_medical_image_file` instead!")
 def save_3d_file(image_3d, path_to_save):
     return save_medical_image_file(image_3d, path_to_save)
 
 
 def save_medical_image_file(image_3d: sitk.Image, path_to_save: str):
     file_meta = FileMetaDataset()
-    ds = FileDataset(path_to_save, {},
-                     file_meta=file_meta)  # , preamble=b"\0" * 128)
+    ds = FileDataset(path_to_save, {}, file_meta=file_meta)  # , preamble=b"\0" * 128)
 
     # transform array to 3D image
     image_3d = sitk.GetImageFromArray(image_3d)
 
     # Set creation date/time
     dt = datetime.datetime.now()
-    ds.ContentDate = dt.strftime('%Y%m%d')
-    timeStr = dt.strftime('%H%M%S.%3f')  # long format with micro seconds
+    ds.ContentDate = dt.strftime("%Y%m%d")
+    timeStr = dt.strftime("%H%M%S.%3f")  # long format with micro seconds
     ds.ContentTime = timeStr
     # ds.save_as(path_to_save, write_like_original=True)
     sitk.WriteImage(image_3d, path_to_save)  # , imageIO='NiftiImageIO')
```

## mipkit/medical/vis.py

```diff
@@ -1,12 +1,15 @@
 import matplotlib.pyplot as plt
 import numpy as np
+
 from .. import immulshow
 
 
-def im3dshow(image_3d, slide_x_pos=0, slide_y_pos=0, slide_z_pos=0, ratio_size=10, **kwargs):
+def im3dshow(
+    image_3d, slide_x_pos=0, slide_y_pos=0, slide_z_pos=0, ratio_size=10, **kwargs
+):
     slide_x_view = image_3d[slide_x_pos, :, :]
     slide_y_view = image_3d[:, slide_y_pos, :][::-1]
     slide_z_view = image_3d[:, :, slide_z_pos][::-1]
-    return immulshow([slide_x_view, slide_y_view, slide_z_view],
-                     ratio_size=ratio_size,
-                     **kwargs)
+    return immulshow(
+        [slide_x_view, slide_y_view, slide_z_view], ratio_size=ratio_size, **kwargs
+    )
```

## mipkit/nlp/__init__.py

```diff
@@ -1,26 +1,26 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-from .text_cleaner import TextCleaner, core, constants
+from .text_cleaner import TextCleaner, constants, core
```

## mipkit/nlp/text_cleaner/__init__.py

```diff
@@ -1,27 +1,27 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 from .cleaner import TextCleaner
-from .core import clean
+from .core import clean
```

## mipkit/nlp/text_cleaner/cleaner.py

```diff
@@ -1,37 +1,37 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-from . import core
-from . import utils
+from . import core, utils
 
 
 class TextCleaner:
+
     @utils.autoargs()
     def __init__(
         self,
         fix_unicode=True,
         to_ascii=True,
         lower=False,
         normalize_whitespace=True,
```

## mipkit/nlp/text_cleaner/constants.py

```diff
@@ -1,38 +1,39 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-from nltk.corpus import stopwords
-import nltk
 import re
 import sys
 import unicodedata
 
+import nltk
+from nltk.corpus import stopwords
+
 CURRENCIES = {
     "$": "USD",
     "z": "PLN",
     "": "GBP",
     "": "JPY",
     "": "THB",
     "": "CRC",
```

## mipkit/nlp/text_cleaner/core.py

```diff
@@ -1,36 +1,37 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 import logging
 import re
 import sys
 from unicodedata import category
+
 from bs4 import BeautifulSoup
 from emoji import UNICODE_EMOJI, demojize, emojize
 from ftfy import fix_text
 
 from . import constants
 from .specials import save_replace
 
@@ -231,15 +232,15 @@
 #     Returns:
 #         str
 #     """
 #     return re.sub(r"[^a-zA-Z\d", " ", text)
 
 
 def remove_punct_with_ignoration(text, ignore_list):
-    return re.sub(fr"[^a-zA-Z\d{''.join(ignore_list)}']", " ", text)
+    return re.sub(rf"[^a-zA-Z\d{''.join(ignore_list)}']", " ", text)
 
 
 def remove_emoji(text):
     for x in UNICODE_EMOJI["en"]:
         if x in text:
             text = text.replace(x, "")
     return text
```

## mipkit/nlp/text_cleaner/specials.py

```diff
@@ -1,30 +1,30 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 import unicodedata
 
 # add new languages here
 specials = {
     "de": {
@@ -42,20 +42,21 @@
 def save_replace(text, lang, back=False):
     # perserve the casing of the original text
     # TODO: performance of matching
 
     # normalize the text to make sure to really match all occurences
     text = norm(text)
 
-    possibilities = (specials[lang]["case_sensitive"] +
-                     [[norm(x[0]), x[1]]
-                      for x in specials[lang]["case_insensitive"]] +
-                     [[norm(x[0].upper()), x[1].upper()]
-                      for x in specials[lang]["case_insensitive"]])
+    possibilities = (
+        specials[lang]["case_sensitive"]
+        + [[norm(x[0]), x[1]] for x in specials[lang]["case_insensitive"]]
+        + [
+            [norm(x[0].upper()), x[1].upper()]
+            for x in specials[lang]["case_insensitive"]
+        ]
+    )
     for pattern, target in possibilities:
         if back:
-            text = text.replace(escape_sequence + target + escape_sequence,
-                                pattern)
+            text = text.replace(escape_sequence + target + escape_sequence, pattern)
         else:
-            text = text.replace(pattern,
-                                escape_sequence + target + escape_sequence)
+            text = text.replace(pattern, escape_sequence + target + escape_sequence)
     return text
```

## mipkit/nlp/text_cleaner/utils.py

```diff
@@ -1,44 +1,44 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
-import inspect
 import functools
+import inspect
 
 
 # https://stackoverflow.com/questions/3652851/what-is-the-best-way-to-do-automatic-attribute-assignment-in-python-and-is-it-a
 # Thank to an implementation from Stackoverflow
 def autoargs(*include, **kwargs):
     def _autoargs(func):
         attrs, varargs, varkw, defaults = inspect.getargspec(func)
 
         def sieve(attr):
-            if kwargs and attr in kwargs['exclude']:
+            if kwargs and attr in kwargs["exclude"]:
                 return False
             if not include or attr in include:
                 return True
             else:
                 return False
 
         @functools.wraps(func)
@@ -51,20 +51,20 @@
             # handle positional arguments
             positional_attrs = attrs[1:]
             for attr, val in zip(positional_attrs, args):
                 if sieve(attr):
                     setattr(self, attr, val)
             # handle varargs
             if varargs:
-                remaining_args = args[len(positional_attrs):]
+                remaining_args = args[len(positional_attrs) :]
                 if sieve(varargs):
                     setattr(self, varargs, remaining_args)
             # handle varkw
             if kwargs:
                 for attr, val in kwargs.items():
                     if sieve(attr):
                         setattr(self, attr, val)
             return func(self, *args, **kwargs)
 
         return wrapper
 
-    return _autoargs
+    return _autoargs
```

## mipkit/pytorch/__init__.py

```diff
@@ -1,33 +1,32 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 import warnings
+
 try:
     import torch
-    from . import hook
-    from . import utils
+
+    from . import hook, utils
 except ImportError as e:
     warnings.warn(e.msg)
-    
-
```

## mipkit/pytorch/base.py

```diff
@@ -1,68 +1,78 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 
 import pytorch_lightning as pl
 from torch.utils.data import DataLoader
 
 
 class DataLoader(pl.LightningDataModule):
-    def __init__(self, train_dataset,
-                 val_dataset=None,
-                 test_dataset=None,
-                 batch_size=1,
-                 num_workers=1,
-                 pin_memory=False):
+
+    def __init__(
+        self,
+        train_dataset,
+        val_dataset=None,
+        test_dataset=None,
+        batch_size=1,
+        num_workers=1,
+        pin_memory=False,
+    ):
         super().__init__()
         self.train_dataset = train_dataset
         self.val_dataset = val_dataset
         self.test_dataset = test_dataset
         self.batch_size = batch_size
         self.num_workers = num_workers
         self.pin_memory = pin_memory
 
     def train_dataloader(self):
-        return DataLoader(self.train_dataset,
-                          batch_size=self.batch_size,
-                          shuffle=True,
-                          num_workers=self.num_workers,
-                          drop_last=True,
-                          pin_memory=self.pin_memory)
+        return DataLoader(
+            self.train_dataset,
+            batch_size=self.batch_size,
+            shuffle=True,
+            num_workers=self.num_workers,
+            drop_last=True,
+            pin_memory=self.pin_memory,
+        )
 
     def val_dataloader(self):
-        return DataLoader(self.val_dataset,
-                          batch_size=self.batch_size,
-                          shuffle=False,
-                          drop_last=False,
-                          num_workers=self.num_workers,
-                          pin_memory=True)
+        return DataLoader(
+            self.val_dataset,
+            batch_size=self.batch_size,
+            shuffle=False,
+            drop_last=False,
+            num_workers=self.num_workers,
+            pin_memory=True,
+        )
 
     def test_dataloader(self):
-        return DataLoader(self.test_dataset,
-                          batch_size=self.batch_size,
-                          shuffle=False,
-                          drop_last=False,
-                          num_workers=self.num_workers,
-                          pin_memory=True)
+        return DataLoader(
+            self.test_dataset,
+            batch_size=self.batch_size,
+            shuffle=False,
+            drop_last=False,
+            num_workers=self.num_workers,
+            pin_memory=True,
+        )
```

## mipkit/pytorch/hook.py

```diff
@@ -1,23 +1,26 @@
 import warnings
 from collections import OrderedDict
-from .utils import convert_pymodule_to_flatten_dict
+
 from ..logger import turn_red
+from .utils import convert_pymodule_to_flatten_dict
+
 try:
     import torch.nn as nn
 except ImportError as e:
     warnings.warn(e.msg)
 
 
 class PytorchHook(nn.Module):
+
     def __init__(self, model, output_layers, *args, **kwargs):
         """Forward Hook is to extract outputs from specific layers.
 
         Args:
-            model (torch.Module): 
+            model (torch.Module):
             output_layers ([type]): [description]
         """
         super().__init__(*args, **kwargs)
         self.output_layers = output_layers
         self.layer_outputs: dict = OrderedDict()
         self.model = model
         self.model_dict = convert_pymodule_to_flatten_dict(model)
@@ -43,34 +46,37 @@
 
     def forward(self, *args, **kwargs):
         return self.model(*args, **kwargs)
 
     def _hook_func(self, layer_name):
         def hook(module, input, output):
             self.layer_outputs[layer_name] = output
+
         return hook
 
 
 class ForwardHook(PytorchHook):
+
     def register_hook(self):
         for layer_name in self.output_layers:
             layer_module = self.model_dict.get(layer_name, None)
             if layer_module is None:
-                message = turn_red(f'Not found layer name `{layer_name}`')
+                message = turn_red(f"Not found layer name `{layer_name}`")
                 warnings.warn(message)
                 continue
             self.hook_handles.append(
-                layer_module.register_forward_hook(
-                    self._hook_func(layer_name)))
+                layer_module.register_forward_hook(self._hook_func(layer_name))
+            )
 
 
 class BackwardHook(PytorchHook):
+
     def register_hook(self):
         for layer_name in self.output_layers:
             layer_module = self.model_dict.get(layer_name, None)
             if layer_module is None:
-                message = turn_red(f'Not found layer name `{layer_name}`')
+                message = turn_red(f"Not found layer name `{layer_name}`")
                 warnings.warn(message)
                 continue
             self.hook_handles.append(
-                layer_module.register_backward_hook(
-                    self._hook_func(layer_name)))
+                layer_module.register_backward_hook(self._hook_func(layer_name))
+            )
```

## mipkit/pytorch/losses.py

```diff
@@ -1,49 +1,51 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
 # Copyright (c) 2021 congvm
-# 
+#
 # This software is released under the MIT License.
 # https://opensource.org/licenses/MIT
 
 import torch
 import torch.nn as nn
+
 # torch.set_printoptions(precision=4, sci_mode=False, linewidth=150)
 
 
 class FocalBCE(nn.Module):
+
     def __init__(self, gamma=2):
         self.gamma = gamma
 
     def forward(self, logits, targets):
         num_classes = targets.size(1)
         l = logits.reshape(-1)
         t = targets.reshape(-1)
         p = torch.sigmoid(l)
-        p = torch.where(t >= 0.5, p, 1-p)
-        logp = - torch.log(torch.clamp(p, 1e-4, 1-1e-4))
-        loss = logp*((1-p)**self.gamma)
-        loss = num_classes*loss.mean()
-        return loss
+        p = torch.where(t >= 0.5, p, 1 - p)
+        logp = -torch.log(torch.clamp(p, 1e-4, 1 - 1e-4))
+        loss = logp * ((1 - p) ** self.gamma)
+        loss = num_classes * loss.mean()
+        return loss
```

## mipkit/pytorch/utils.py

```diff
@@ -1,45 +1,47 @@
-from collections import OrderedDict
 import warnings
+from collections import OrderedDict
+
 try:
-    import torch
-    import numpy as np
     import random
+
+    import numpy as np
+    import torch
 except ImportError as e:
     warnings.warn(e.msg)
 
+
 def convert_pymodule_to_flatten_dict(model):
     all_layers = OrderedDict()
 
-    def collect_layers(module, all_layers, previous_layer_name=''):
-        layers = getattr(module, 'named_children', dict())
+    def collect_layers(module, all_layers, previous_layer_name=""):
+        layers = getattr(module, "named_children", dict())
         if not isinstance(layers, dict):
             layers = dict(list(layers()))
 
             if len(layers) > 0:
-
-                if previous_layer_name != '':
+                if previous_layer_name != "":
                     all_layers[previous_layer_name] = module
 
                 layers_ = layers.copy()
                 for layer_name, layer_module in layers_.items():
-                    if previous_layer_name != '':
-                        lname = previous_layer_name + '.' + layer_name
+                    if previous_layer_name != "":
+                        lname = previous_layer_name + "." + layer_name
                     else:
                         lname = layer_name
                     collect_layers(layer_module, all_layers, lname)
             else:
                 all_layers[previous_layer_name] = module
 
     collect_layers(model, all_layers)
     return all_layers
 
 
 def convert_pymodule_to_tree(model):
-    layers = getattr(model, 'named_children', OrderedDict())
+    layers = getattr(model, "named_children", OrderedDict())
     if not isinstance(layers, OrderedDict):
         layers = OrderedDict(list(layers()))
         if len(layers) > 0:
             for layer_name, layer_module in layers.items():
                 layers[layer_name] = convert_pymodule_to_tree(layer_module)
         else:
             return model
@@ -55,20 +57,21 @@
     pl.seed_everything(seed)
     torch.manual_seed(seed)
     np.random.seed(seed)
     random.seed(seed)
 
 
 def tensor_to_numpy(tensor):
-    return tensor.detach().to('cpu').numpy()
+    return tensor.detach().to("cpu").numpy()
 
 
 def get_imagenet_transform():
     """Initialize pytorch transform composer for ImageNet.
        This function is for experiments
 
     Returns:
         transform: torchvision.transform.Compose
     """
     from torchvision import transforms as T
+
     transform = T.Compose([T.Resize((224, 224)), T.ToTensor()])
-    return transform
+    return transform
```

## Comparing `mipkit/multiprocessing.py` & `mipkit/mprocess.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,35 +1,36 @@
 """
- The MIT License (MIT)
- Copyright (c) 2021 Cong Vo
- 
- Permission is hereby granted, free of charge, to any person obtaining a copy
- of this software and associated documentation files (the "Software"), to deal
- in the Software without restriction, including without limitation the rights
- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- copies of the Software, and to permit persons to whom the Software is
- furnished to do so, subject to the following conditions:
- 
- The above copyright notice and this permission notice shall be included in
- all copies or substantial portions of the Software.
- 
- Provided license texts might have their own copyrights and restrictions
- 
- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- THE SOFTWARE.
+The MIT License (MIT)
+Copyright (c) 2021 Cong Vo
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+Provided license texts might have their own copyrights and restrictions
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
 """
 
+import warnings
 from multiprocessing import Pool, cpu_count
 from multiprocessing.pool import ThreadPool
-import warnings
+
 try:
     from tqdm import tqdm
 except ImportError as e:
     warnings.warn(e.msg)
 
 
 def pool_worker(
```

## Comparing `mipkit-1.6.3.dist-info/LICENSE` & `mipkit-1.6.4.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mipkit-1.6.3.dist-info/METADATA` & `mipkit-1.6.4.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mipkit
-Version: 1.6.3
+Version: 1.6.4
 Summary: mipkit
 Author: Cong M. Vo
 Author-email: congvm.it@gmail.com
 License: MIT
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
```

## Comparing `mipkit-1.6.3.dist-info/RECORD` & `mipkit-1.6.4.dist-info/RECORD`

 * *Files 27% similar despite different names*

```diff
@@ -1,49 +1,50 @@
-mipkit/__init__.py,sha256=GD2Ho1YEzjdtKmCUjdWL0dtHdVRHp0CyAqVLxOf-2E4,1531
-mipkit/audio.py,sha256=5DEPIwBMsduJae98tafJcXwyGsyyWEDe6MNXqHI2EdA,4301
-mipkit/debug.py,sha256=Fur_KrWqoFs5smf0Lm0LJFFnjhFTIFvtjr7F1_ojmVM,2370
-mipkit/downloaders.py,sha256=EY03FnADT405PsaTeRsUIXiGhm1DfP2AEhUpgW5EFiU,2292
-mipkit/helpers.py,sha256=41QAq_AOdAKRQiKzeBsjM5HEaP15rGgn9N951PFso_s,518
-mipkit/images.py,sha256=gSWBzF7jMFToijbztU9uSlL_rRDPkxo0kYBdNKsqGok,9092
-mipkit/logger.py,sha256=HUsHFVXYrfMpqT52mP3J-0uTLseWo7J7uniCmL6lqDA,2265
-mipkit/multiprocessing.py,sha256=IljYawnc1vtq2K3cGgJFoTgmyErdx5n5DeIQfc8xJ58,2691
-mipkit/pdf.py,sha256=gCFTpW-8zQpoIsxXhE2_lS3RS-Bup-5ZM4Qy5md3mX8,3201
-mipkit/pl_utils.py,sha256=DFPS2sgpBaKAKNpTZX_TB8pnpG97Wc98DePCpAEljpE,4058
-mipkit/stats.py,sha256=JzPoCEdZ1NeYnECNUMi0cV1p9QnLencvkDFDJ6t85mc,1981
-mipkit/utils.py,sha256=9IYw-VEaH91T4aISVgpe6EAdK3AVbDoTGJJv-OTKD2Y,9758
-mipkit/video.py,sha256=8fVCzcxGOSo03Jc3le9a7NmdWruylVuflDPttRlScMY,2225
-mipkit/vis.py,sha256=csLLjDIxG-9z0Bt749udFS_lNoY2tKr8jHq6K25P6MI,13205
-mipkit/dl/__init__.py,sha256=0nNiT9DmD8a4vKWfu5vuAFII8LYyuzH5wKLE5CSiWzg,1264
-mipkit/dl/losses.py,sha256=asIk29Sa3G0J7Wk9whrHdMHhMVGw3rF9I3yII7k_r_I,3530
-mipkit/dl/metrics.py,sha256=HmB3K0Ij4QydFjWvS-5XQ_h9jqVMC2fbSE7zDyNlWJ4,4002
-mipkit/dl/summary.py,sha256=dgYSdrNSk-Bc29fKRYHF77450a15lEvBIdvooXPtJAQ,5174
-mipkit/dl/tune.py,sha256=Bic1K5jS6CKXuiUKzCu45TDUmJ0sp8swW_3vCRkGvio,4567
+mipkit/__init__.py,sha256=Imn-BLFfldYnfx2QylzzH5TPA9ooVzeLzTkWJiteoRQ,1425
+mipkit/audio.py,sha256=0JZylYYoAOwxmAwL08LvGJNHtGo7KgDYngVM_9yQhXA,4268
+mipkit/debug.py,sha256=9wAh2yZsdcU0XY6w8oj45PJIPmCQ28arD9HhNLf_iRk,2469
+mipkit/downloaders.py,sha256=kZ1vRkV-D7vYiC-IuWp4dcZsB8XDt4bwsyTsGic4yOQ,2317
+mipkit/helpers.py,sha256=OMh3nMmEhEEGComMQyg2bmiMTRsArinruqvp0k7y9OM,517
+mipkit/images.py,sha256=aya7pvwKj0AlHYB_HdKlQP-3n1vkT5_6EX9m4WeJc2s,9084
+mipkit/logger.py,sha256=XPnmETkOE39OZwEXViyzzzKDEefAmOBatC4XHjVSbq4,2245
+mipkit/mprocess.py,sha256=-3PfoULMljyzST1CFhD1B-jkBoJNnKD3Yr0e3pNxk8U,2670
+mipkit/nest_asyncio.py,sha256=n-89xHaZsupwidDXDJP4fF8BKXIqnV-_d1gTkMXjKXw,8062
+mipkit/pdf.py,sha256=4_7Wtax4nnWUZKqaA1DDYXod-SWvlOha0ZhUHOW60GY,3203
+mipkit/pl_utils.py,sha256=PuSyxlL_Ka0VEeyZhufAM-bDb8npttN-AK_QLx7gaXs,3751
+mipkit/stats.py,sha256=Ypx15egARUHcqDhI6VVG3m-Or4Kx3c1CNFsWqq0nstw,1956
+mipkit/utils.py,sha256=64UilwLLjaDyCfqnMzJnoM97e_e7hX4yQZmETCEMI2E,9810
+mipkit/video.py,sha256=9B24AC6lsnRpeKeADqEI4yLQ0Ip53bwkCE2O0j-gbrk,2229
+mipkit/vis.py,sha256=vpqqE51fl5loI4CXjd12S0CaV1liG3FjdChv4EU1ZAo,13188
+mipkit/dl/__init__.py,sha256=YLe9TirkFxtu5k_E70XbKx7Ex14saWafXAyld1mXsCo,1243
+mipkit/dl/losses.py,sha256=AZbL1dN-gVtyPj-Pok1XXSEaxJcLRt7wu1DdHPIHbqQ,3391
+mipkit/dl/metrics.py,sha256=j9E0OxW8yg66abnx-VQ8Z0x3cbeELz3O1Q6kcUoCUJ0,3980
+mipkit/dl/summary.py,sha256=yXKDVEt7BnLWXj9h9KoSCWnPFokzV81L2_K33iZ4crU,5045
+mipkit/dl/tune.py,sha256=YAVtptja1AMCXbD26rEpSkDTlfMO1I7H_IbMBxz189I,4234
 mipkit/dl/utils.py,sha256=BRYiSicwTp_b-9juuoIdztH_XKZHwopydjI5Tl4BaR8,2650
-mipkit/faces/__init__.py,sha256=HEqnEm96hVzpKW0NAvg23OlxYfRbgbeLueQgX8ZB2wU,1226
-mipkit/faces/faces_utils.py,sha256=TvkaTyxpWdj-pTRaG54LI_s_geSNnCQFtxWWoTxhFZ4,3584
-mipkit/faces/helpers.py,sha256=sj4Q1eahsmN0hcoi2JeOE3iEpNpxcHyhRrEEzCTz4gU,1645
-mipkit/ip/__init__.py,sha256=uAiLq8CpL70koisXdGGYrfbAOErWG8xg3uiB4m1B4Ek,1255
-mipkit/ip/fft.py,sha256=0-2uJYKr0oeJMKZTRkpdJXXh1Ncwu4chn9pl9LyYzbg,3593
-mipkit/ip/freq_filters.py,sha256=ns2zLCPrgw5cG8n-3b2WjuuZp9_v6ZvYujxkpKL3YsQ,8485
-mipkit/medical/__init__.py,sha256=2BI6ffbDfoJvItNcQTBkYTFXhFctXi8btgJnX2PHr38,1369
-mipkit/medical/itk_snap.py,sha256=PxCkTnisTcW3S9hVgeEOxlxrRwRV-bR9dCZPrIPoxYU,1763
-mipkit/medical/utils.py,sha256=ESRyATd5n5fAigFX0-9jpIuGAMn0fu8rPO5ZKBDuwMU,4527
-mipkit/medical/vis.py,sha256=9bnBThS2S5a8y1PsWx3mOO_XuQluWcE5qXM5Gg22qyk,465
-mipkit/nlp/__init__.py,sha256=uQNGVVdbAGD3XZ1rHp-UOPhIjHkUjcVosZ67xEqO17I,1231
-mipkit/nlp/text_cleaner/__init__.py,sha256=Nm7GXeQsMktc9Pouo4dovJz7K8QVGo2YHhAaQAPoaa8,1233
-mipkit/nlp/text_cleaner/cleaner.py,sha256=Tps1wbVY4txokojD5VViw78DchAcziiT6M3JISBMjVE,3718
-mipkit/nlp/text_cleaner/constants.py,sha256=cRQOhXXj-7trdciALWRYjhxZaoxjStCpZzHo6exjeL0,13483
-mipkit/nlp/text_cleaner/core.py,sha256=h9aWLbdPRo-0qzhP8iTI-ZJmQujYgosoSerN6l-9wOw,13466
-mipkit/nlp/text_cleaner/specials.py,sha256=AxHJejgfZmUh1UZ34qOp2SvTwkB-4OI6SkohyejZEgI,2293
-mipkit/nlp/text_cleaner/utils.py,sha256=GTumG7-p5A_Xg-kYzzlfUv8DuBVaSWnYdcrcK0ei8V4,2741
-mipkit/pytorch/__init__.py,sha256=lew6QbAsoC8kOPHqnwOfyGCtxiOrgpCnoU__DVhbutw,1317
-mipkit/pytorch/base.py,sha256=kAUiGggAyQ2ZGnj2A4KlfUOek_6v3zOGnPOEP-k8n2k,2715
-mipkit/pytorch/hook.py,sha256=LY5JuJKLTuCfi3jDPYyt3SKZZlRJCQ_udmk5eRLTraw,2415
-mipkit/pytorch/losses.py,sha256=Xmf70s9w_vylhPv4fyZXhiZYwRpbwDjPmEd5mo6LTsI,1859
-mipkit/pytorch/utils.py,sha256=l6oHhayEoS978a8j71yk9DhLbnDgw86Ce24AvoE0_2s,2145
-mipkit-1.6.3.dist-info/LICENSE,sha256=kJbV-BonYNbdVk6iszch7OzaGidRveSSpTjvTSgjapE,1097
-mipkit-1.6.3.dist-info/METADATA,sha256=Q0NqPaTBWhE1MyxTvAm1UUvCjhJTuQfBH-DBEZUkEiI,1180
-mipkit-1.6.3.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-mipkit-1.6.3.dist-info/entry_points.txt,sha256=lkg81TboFiNKRtDNQnWSf3NrWW_OKC_gyZPOQHb6UM0,46
-mipkit-1.6.3.dist-info/top_level.txt,sha256=cCCsSL2jjFrN5HxBLyCTeJMrscTh88S21Q8M1s6zU3w,7
-mipkit-1.6.3.dist-info/zip-safe,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
-mipkit-1.6.3.dist-info/RECORD,,
+mipkit/faces/__init__.py,sha256=RDjJl6LlLeEonA3boYzq2iYP4Opk-VyFORuDOFH-ejw,1205
+mipkit/faces/faces_utils.py,sha256=DGnJALN_LgEPi6dZQn34dq7HgPFVxMJUD9RHLNUdPjA,3487
+mipkit/faces/helpers.py,sha256=Fr30lLrrZQL7l44qOYHl-rVl3-dAzYBHwX64AujJuL4,1616
+mipkit/ip/__init__.py,sha256=_5oxpzzurGo5V7597abK8Lrjq5rxoXliHIKYnvOZgmM,1234
+mipkit/ip/fft.py,sha256=5-TKNci8IolsJ5DyUTON6IytZecK7KR2qLlpNZGgDE0,3538
+mipkit/ip/freq_filters.py,sha256=sl5HKOeXI30KuOFli-KN2PI2T-ioi5eNc2c6wgLQK38,8421
+mipkit/medical/__init__.py,sha256=wFaKGO8moxuOILMVflNeXTdcX2pwQmoIHqSSR2pAdLo,1352
+mipkit/medical/itk_snap.py,sha256=zrTasoj1Fn8LMy6UpGuiFGHLus86HhuMv0WtmWfeP-Y,1757
+mipkit/medical/utils.py,sha256=qqkD0a8N_g1tK6ZLmeCDPHF0fjHV1Ts8FgjgdKFfzbE,4489
+mipkit/medical/vis.py,sha256=gjsSkGI938RYtCTxin4M0Lz1LamqFmW8_VJFQsJ9TNY,444
+mipkit/nlp/__init__.py,sha256=_u1h0jjlV-QXoyCDGE39y9a9ft0Yd0N5pvwoCd6Qc3k,1210
+mipkit/nlp/text_cleaner/__init__.py,sha256=oZSheUNoYXQNv2BmOVLHXRTT0FkRamwzSovB35oeKU4,1212
+mipkit/nlp/text_cleaner/cleaner.py,sha256=qaHiVAAWuXNzuP-yK_FhTz_Lhax60X092pgx2FvnBeQ,3684
+mipkit/nlp/text_cleaner/constants.py,sha256=1_1ILcLlVeancNf2cmTvhdFynP494T8MW1l2l4Z7pjQ,13462
+mipkit/nlp/text_cleaner/core.py,sha256=sMzwIRx4gJZ3RkGsqPQjAdG6HZj4SGygrnL4sU1EMPc,13445
+mipkit/nlp/text_cleaner/specials.py,sha256=TNZYyRkVw3lcMp4ptg0Hbz-Mz8dikDgQryJlMpyT6mk,2185
+mipkit/nlp/text_cleaner/utils.py,sha256=CWPwMUOZhyg03FEHlqnGsfDHjGG1az7XpP5nvP8TFOQ,2721
+mipkit/pytorch/__init__.py,sha256=y6jWzlPqYEGqoAMltiY-CIPeLDz6ZUUGVy8My_0fvqg,1274
+mipkit/pytorch/base.py,sha256=OUnjLjZt8qI-EcR9TT4WhfswF5DwAKCw2Ct3ZfSaOfw,2531
+mipkit/pytorch/hook.py,sha256=KhHO_V2Yf-q34Nap5-TKUoloSdRewS6KsCpwxlf84kg,2405
+mipkit/pytorch/losses.py,sha256=vR98xK5ce5FtdrMs7Gb0EMTHCkEybNMLLT0oyx6J6YU,1850
+mipkit/pytorch/utils.py,sha256=DmNcHhtduen44D1Lg8d4Y0DcM9UvHp2jUBSIrGFxN6U,2149
+mipkit-1.6.4.dist-info/LICENSE,sha256=kJbV-BonYNbdVk6iszch7OzaGidRveSSpTjvTSgjapE,1097
+mipkit-1.6.4.dist-info/METADATA,sha256=qLCelx7f9ZlkQKLknukPAsdrqpx-PtYRKTp5__NmKGQ,1180
+mipkit-1.6.4.dist-info/WHEEL,sha256=yQN5g4mg4AybRjkgi-9yy4iQEFibGQmlz78Pik5Or-A,92
+mipkit-1.6.4.dist-info/entry_points.txt,sha256=lkg81TboFiNKRtDNQnWSf3NrWW_OKC_gyZPOQHb6UM0,46
+mipkit-1.6.4.dist-info/top_level.txt,sha256=cCCsSL2jjFrN5HxBLyCTeJMrscTh88S21Q8M1s6zU3w,7
+mipkit-1.6.4.dist-info/zip-safe,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
+mipkit-1.6.4.dist-info/RECORD,,
```

